
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>üß™ Packet Sniffing & Monitoring on Linux - Jetson Cyber & AI Summer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#packet-sniffing-monitoring-on-linux" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Jetson Cyber &amp; AI Summer Camp" class="md-header__button md-logo" aria-label="Jetson Cyber & AI Summer Camp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jetson Cyber & AI Summer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üß™ Packet Sniffing &amp; Monitoring on Linux
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jetson Cyber &amp; AI Summer Camp" class="md-nav__button md-logo" aria-label="Jetson Cyber & AI Summer Camp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Jetson Cyber & AI Summer Camp
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üî∞ Getting Started with Jetson
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üî∞ Getting Started with Jetson
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_sjsujetsontool_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚úÖ sjsujetsontool Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00b_sjsujetsontool_cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìã sjsujetsontool Cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01a_nvidia_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîß Introduction to NVIDIA Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01b_jetson_cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ CUDA Programming on Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üêß Linux Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üêß Linux Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02a_linux_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üí° Linux OS Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03a_linux_networking_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üåê Linux Networking Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü§ñ AI & LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ü§ñ AI & LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_transformers_nlp_applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üß† Transformers & NLP Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_llms_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ Large Language Models on Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_nlp_applications_llm_optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìö NLP Applications & LLM Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_prompt_engineering_langchain_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚úçÔ∏è Prompt Engineering & LangChain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_rag_app_langchain_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîé RAG Applications with LangChain
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-a-network-packet" class="md-nav__link">
    <span class="md-ellipsis">
      üì¶ What Is a Network Packet?
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üì¶ What Is a Network Packet?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-protocols-seen-in-packets" class="md-nav__link">
    <span class="md-ellipsis">
      üß¨ Common Protocols Seen in Packets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tools-for-sniffing-and-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      üõ†Ô∏è Tools for Sniffing and Monitoring
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üõ†Ô∏è Tools for Sniffing and Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-tcpdump-cli-packet-sniffer" class="md-nav__link">
    <span class="md-ellipsis">
      1. tcpdump ‚Äî CLI Packet Sniffer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-wireshark-gui-packet-analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      2. wireshark ‚Äî GUI Packet Analyzer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. wireshark ‚Äî GUI Packet Analyzer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#common-use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ Common Use Cases
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-iftop-real-time-bandwidth-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      3. iftop ‚Äî Real-Time Bandwidth Monitor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-nethogs-bandwidth-by-process" class="md-nav__link">
    <span class="md-ellipsis">
      4. nethogs ‚Äî Bandwidth by Process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-netstat-ss-socket-info" class="md-nav__link">
    <span class="md-ellipsis">
      5. netstat / ss ‚Äî Socket Info
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ethical-use-and-legal-reminder" class="md-nav__link">
    <span class="md-ellipsis">
      üîê Ethical Use and Legal Reminder
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-lab-jetson-network-analysis-protocol-understanding" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ Advanced Lab: Jetson Network Analysis &amp; Protocol Understanding
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß™ Advanced Lab: Jetson Network Analysis &amp; Protocol Understanding">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objectives" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Objectives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jetson-specific-setup" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ Jetson-Specific Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="‚úÖ Jetson-Specific Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-interface-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Network Interface Configuration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#containerized-wireshark-setup-no-sudo-required" class="md-nav__link">
    <span class="md-ellipsis">
      üê≥ Containerized Wireshark Setup (No Sudo Required)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üê≥ Containerized Wireshark Setup (No Sudo Required)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#method-1-x11-forwarding-with-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Method 1: X11 Forwarding with Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-web-based-wireshark" class="md-nav__link">
    <span class="md-ellipsis">
      Method 2: Web-based Wireshark
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-3-custom-jetson-wireshark-container" class="md-nav__link">
    <span class="md-ellipsis">
      Method 3: Custom Jetson Wireshark Container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-packet-analysis-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      üõ†Ô∏è Advanced Packet Analysis Tasks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üõ†Ô∏è Advanced Packet Analysis Tasks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#task-1-multi-interface-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Task 1: Multi-Interface Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-2-protocol-specific-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Task 2: Protocol-Specific Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#task-3-real-time-protocol-analysis-with-tshark" class="md-nav__link">
    <span class="md-ellipsis">
      Task 3: Real-time Protocol Analysis with tshark
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-protocol-understanding-exercises" class="md-nav__link">
    <span class="md-ellipsis">
      üìä Network Protocol Understanding Exercises
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìä Network Protocol Understanding Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exercise-1-tcp-three-way-handshake-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 1: TCP Three-Way Handshake Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-2-http-vs-https-traffic-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 2: HTTP vs HTTPS Traffic Comparison
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exercise-3-dns-resolution-deep-dive" class="md-nav__link">
    <span class="md-ellipsis">
      Exercise 3: DNS Resolution Deep Dive
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-monitoring-scripts" class="md-nav__link">
    <span class="md-ellipsis">
      üîç Advanced Monitoring Scripts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîç Advanced Monitoring Scripts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automated-network-monitoring-script" class="md-nav__link">
    <span class="md-ellipsis">
      Automated Network Monitoring Script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#real-time-protocol-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Real-time Protocol Dashboard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comprehensive-lab-deliverables" class="md-nav__link">
    <span class="md-ellipsis">
      üìã Comprehensive Lab Deliverables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìã Comprehensive Lab Deliverables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#part-1-container-setup-20-points" class="md-nav__link">
    <span class="md-ellipsis">
      Part 1: Container Setup (20 points)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-2-protocol-analysis-30-points" class="md-nav__link">
    <span class="md-ellipsis">
      Part 2: Protocol Analysis (30 points)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-3-advanced-monitoring-25-points" class="md-nav__link">
    <span class="md-ellipsis">
      Part 3: Advanced Monitoring (25 points)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-4-real-time-dashboard-15-points" class="md-nav__link">
    <span class="md-ellipsis">
      Part 4: Real-time Dashboard (15 points)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#part-5-security-analysis-10-points" class="md-nav__link">
    <span class="md-ellipsis">
      Part 5: Security Analysis (10 points)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-challenge-iot-device-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Advanced Challenge: IoT Device Analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#report-template" class="md-nav__link">
    <span class="md-ellipsis">
      üìù Report Template
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="packet-sniffing-monitoring-on-linux">üß™ Packet Sniffing &amp; Monitoring on Linux<a class="headerlink" href="#packet-sniffing-monitoring-on-linux" title="Permanent link">&para;</a></h1>
<h2 id="what-is-a-network-packet">üì¶ What Is a Network Packet?<a class="headerlink" href="#what-is-a-network-packet" title="Permanent link">&para;</a></h2>
<p>A <strong>network packet</strong> is the basic unit of data transferred over a network. Each packet contains two main parts:</p>
<ul>
<li><strong>Header</strong>: Metadata like source/destination IP, protocol, port, and more.</li>
<li><strong>Payload</strong>: Actual data (e.g., part of a file, message, or request).</li>
</ul>
<h3 id="common-protocols-seen-in-packets">üß¨ Common Protocols Seen in Packets<a class="headerlink" href="#common-protocols-seen-in-packets" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Protocol</th>
<th>Layer</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Ethernet</td>
<td>Data Link</td>
<td>Connect devices on a LAN</td>
</tr>
<tr>
<td>IP</td>
<td>Network</td>
<td>Routing between networks</td>
</tr>
<tr>
<td>TCP/UDP</td>
<td>Transport</td>
<td>Reliable/fast transport of data</td>
</tr>
<tr>
<td>HTTP/HTTPS</td>
<td>Application</td>
<td>Web communication</td>
</tr>
<tr>
<td>DNS</td>
<td>Application</td>
<td>Domain name resolution</td>
</tr>
<tr>
<td>ICMP</td>
<td>Network</td>
<td>Diagnostics (e.g., ping)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="tools-for-sniffing-and-monitoring">üõ†Ô∏è Tools for Sniffing and Monitoring<a class="headerlink" href="#tools-for-sniffing-and-monitoring" title="Permanent link">&para;</a></h2>
<h3 id="1-tcpdump-cli-packet-sniffer">1. <code>tcpdump</code> ‚Äî CLI Packet Sniffer<a class="headerlink" href="#1-tcpdump-cli-packet-sniffer" title="Permanent link">&para;</a></h3>
<p>A powerful command-line tool to capture and inspect network traffic.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>tcpdump
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>&lt;interface&gt;
</code></pre></div>
<p>Common usage:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>wlan0
sudo<span class="w"> </span>tcpdump<span class="w"> </span>port<span class="w"> </span><span class="m">80</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-w<span class="w"> </span>packets.pcap
</code></pre></div>
<h3 id="2-wireshark-gui-packet-analyzer">2. <code>wireshark</code> ‚Äî GUI Packet Analyzer<a class="headerlink" href="#2-wireshark-gui-packet-analyzer" title="Permanent link">&para;</a></h3>
<p>Wireshark is a powerful graphical tool used to inspect and analyze network packets in detail.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>wireshark
</code></pre></div>
<p>You can run it with:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>wireshark
</code></pre></div>
<h4 id="common-use-cases">üß™ Common Use Cases<a class="headerlink" href="#common-use-cases" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Live capture</strong>: Choose interface (e.g., wlan0) to monitor live traffic.</li>
<li>
<p><strong>Filter traffic</strong> using expressions:</p>
</li>
<li>
<p><code>http</code> (HTTP only)</p>
</li>
<li><code>ip.addr == 192.168.1.10</code></li>
<li><code>tcp.port == 22</code></li>
<li><strong>Follow TCP stream</strong> to reconstruct conversations</li>
<li><strong>Inspect packet structure</strong>: Ethernet, IP, TCP, and payload layers</li>
</ul>
<blockquote>
<p>üîê Tip: If permissions issue occurs, ensure your user is in the <code>wireshark</code> group:</p>
</blockquote>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>wireshark<span class="w"> </span><span class="nv">$USER</span>
newgrp<span class="w"> </span>wireshark
</code></pre></div>
<p>Wireshark can also open <code>.pcap</code> files captured via <code>tcpdump</code>, allowing post-capture analysis with GUI.</p>
<h3 id="3-iftop-real-time-bandwidth-monitor">3. <code>iftop</code> ‚Äî Real-Time Bandwidth Monitor<a class="headerlink" href="#3-iftop-real-time-bandwidth-monitor" title="Permanent link">&para;</a></h3>
<p>Displays top bandwidth-consuming connections.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>iftop
sudo<span class="w"> </span>iftop<span class="w"> </span>-i<span class="w"> </span>wlan0
</code></pre></div>
<h3 id="4-nethogs-bandwidth-by-process">4. <code>nethogs</code> ‚Äî Bandwidth by Process<a class="headerlink" href="#4-nethogs-bandwidth-by-process" title="Permanent link">&para;</a></h3>
<p>Shows which local processes use network bandwidth.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>nethogs
sudo<span class="w"> </span>nethogs<span class="w"> </span>wlan0
</code></pre></div>
<h3 id="5-netstat-ss-socket-info">5. <code>netstat</code> / <code>ss</code> ‚Äî Socket Info<a class="headerlink" href="#5-netstat-ss-socket-info" title="Permanent link">&para;</a></h3>
<p>Inspect current open ports and connections.</p>
<div class="highlight"><pre><span></span><code>ss<span class="w"> </span>-tulnp
</code></pre></div>
<hr />
<h2 id="ethical-use-and-legal-reminder">üîê Ethical Use and Legal Reminder<a class="headerlink" href="#ethical-use-and-legal-reminder" title="Permanent link">&para;</a></h2>
<ul>
<li>Only sniff packets on <strong>your own network</strong>.</li>
<li>Avoid collecting sensitive data without permission.</li>
<li>Use for <strong>learning, debugging, and securing</strong> your systems.</li>
</ul>
<hr />
<h2 id="advanced-lab-jetson-network-analysis-protocol-understanding">üß™ Advanced Lab: Jetson Network Analysis &amp; Protocol Understanding<a class="headerlink" href="#advanced-lab-jetson-network-analysis-protocol-understanding" title="Permanent link">&para;</a></h2>
<h3 id="objectives">üéØ Objectives<a class="headerlink" href="#objectives" title="Permanent link">&para;</a></h3>
<ol>
<li>Use Jetson-optimized tools for network packet analysis</li>
<li>Run Wireshark in containerized environment without sudo privileges</li>
<li>Understand network protocols through practical packet inspection</li>
<li>Implement automated network monitoring solutions</li>
</ol>
<h3 id="jetson-specific-setup">‚úÖ Jetson-Specific Setup<a class="headerlink" href="#jetson-specific-setup" title="Permanent link">&para;</a></h3>
<h4 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Update system and install Docker (if not already installed)</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade<span class="w"> </span>-y
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>docker.io<span class="w"> </span>docker-compose<span class="w"> </span>-y
sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
<span class="c1"># Logout and login again for group changes to take effect</span>

<span class="c1"># Install additional network tools</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>tcpdump<span class="w"> </span>iftop<span class="w"> </span>nethogs<span class="w"> </span>nmap<span class="w"> </span>tshark<span class="w"> </span>-y
</code></pre></div>
<h4 id="network-interface-configuration">Network Interface Configuration<a class="headerlink" href="#network-interface-configuration" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Check available network interfaces</span>
ip<span class="w"> </span>link<span class="w"> </span>show

<span class="c1"># For Jetson devices, common interfaces:</span>
<span class="c1"># - eth0: Ethernet</span>
<span class="c1"># - wlan0: WiFi (if WiFi module present)</span>
<span class="c1"># - docker0: Docker bridge</span>
<span class="c1"># - l4tbr0: Jetson-specific bridge</span>

<span class="c1"># Enable promiscuous mode for packet capture (if needed)</span>
sudo<span class="w"> </span>ip<span class="w"> </span>link<span class="w"> </span><span class="nb">set</span><span class="w"> </span>wlan0<span class="w"> </span>promisc<span class="w"> </span>on
</code></pre></div>
<h3 id="containerized-wireshark-setup-no-sudo-required">üê≥ Containerized Wireshark Setup (No Sudo Required)<a class="headerlink" href="#containerized-wireshark-setup-no-sudo-required" title="Permanent link">&para;</a></h3>
<h4 id="method-1-x11-forwarding-with-docker">Method 1: X11 Forwarding with Docker<a class="headerlink" href="#method-1-x11-forwarding-with-docker" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Create Wireshark container with X11 support</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>wireshark-jetson<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--net<span class="o">=</span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--privileged<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">DISPLAY</span><span class="o">=</span><span class="nv">$DISPLAY</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>/tmp/.X11-unix:/tmp/.X11-unix:rw<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/captures:/captures<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>linuxserver/wireshark:latest
</code></pre></div>
<h4 id="method-2-web-based-wireshark">Method 2: Web-based Wireshark<a class="headerlink" href="#method-2-web-based-wireshark" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Run Wireshark with web interface</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>wireshark-web<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--net<span class="o">=</span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--privileged<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">3000</span>:3000<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/captures:/captures<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">PUID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">PGID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>linuxserver/wireshark:latest

<span class="c1"># Access via browser: http://jetson-ip:3000</span>
</code></pre></div>
<h4 id="method-3-custom-jetson-wireshark-container">Method 3: Custom Jetson Wireshark Container<a class="headerlink" href="#method-3-custom-jetson-wireshark-container" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.wireshark-jetson</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:20.04</span>

<span class="k">ENV</span><span class="w"> </span><span class="nv">DEBIAN_FRONTEND</span><span class="o">=</span>noninteractive

<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wireshark<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>tshark<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>tcpdump<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>net-tools<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>iputils-ping<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># Add non-root user to wireshark group</span>
<span class="k">RUN</span><span class="w"> </span>groupadd<span class="w"> </span>-r<span class="w"> </span>wireshark<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>useradd<span class="w"> </span>-r<span class="w"> </span>-g<span class="w"> </span>wireshark<span class="w"> </span>-s<span class="w"> </span>/bin/bash<span class="w"> </span>wireshark<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>usermod<span class="w"> </span>-a<span class="w"> </span>-G<span class="w"> </span>wireshark<span class="w"> </span>wireshark

<span class="c"># Set capabilities for non-root packet capture</span>
<span class="k">RUN</span><span class="w"> </span>setcap<span class="w"> </span>cap_net_raw,cap_net_admin<span class="o">=</span>eip<span class="w"> </span>/usr/bin/dumpcap

<span class="k">USER</span><span class="w"> </span><span class="s">wireshark</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/home/wireshark</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Build and run custom container</span>
docker<span class="w"> </span>build<span class="w"> </span>-f<span class="w"> </span>Dockerfile.wireshark-jetson<span class="w"> </span>-t<span class="w"> </span>jetson-wireshark<span class="w"> </span>.

docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>jetson-wireshark<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--net<span class="o">=</span>host<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cap-add<span class="o">=</span>NET_RAW<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--cap-add<span class="o">=</span>NET_ADMIN<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/captures:/home/wireshark/captures<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>jetson-wireshark
</code></pre></div>
<h3 id="advanced-packet-analysis-tasks">üõ†Ô∏è Advanced Packet Analysis Tasks<a class="headerlink" href="#advanced-packet-analysis-tasks" title="Permanent link">&para;</a></h3>
<h4 id="task-1-multi-interface-monitoring">Task 1: Multi-Interface Monitoring<a class="headerlink" href="#task-1-multi-interface-monitoring" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Monitor multiple interfaces simultaneously</span>
<span class="c1"># Terminal 1: Ethernet traffic</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>eth0<span class="w"> </span>-w<span class="w"> </span>eth0_capture.pcap<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># Terminal 2: WiFi traffic (if available)</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>wlan0<span class="w"> </span>-w<span class="w"> </span>wlan0_capture.pcap<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># Terminal 3: Docker bridge traffic</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>docker0<span class="w"> </span>-w<span class="w"> </span>docker_capture.pcap<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># Let it run for 2-3 minutes, then stop all captures</span>
sudo<span class="w"> </span>pkill<span class="w"> </span>tcpdump
</code></pre></div>
<h4 id="task-2-protocol-specific-analysis">Task 2: Protocol-Specific Analysis<a class="headerlink" href="#task-2-protocol-specific-analysis" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Capture specific protocols</span>

<span class="c1"># 1. HTTP/HTTPS traffic analysis</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 80 or port 443&#39;</span><span class="w"> </span>-w<span class="w"> </span>web_traffic.pcap<span class="w"> </span>-c<span class="w"> </span><span class="m">100</span>

<span class="c1"># 2. DNS queries and responses</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 53&#39;</span><span class="w"> </span>-w<span class="w"> </span>dns_traffic.pcap<span class="w"> </span>-c<span class="w"> </span><span class="m">50</span>

<span class="c1"># 3. SSH connections</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 22&#39;</span><span class="w"> </span>-w<span class="w"> </span>ssh_traffic.pcap<span class="w"> </span>-c<span class="w"> </span><span class="m">30</span>

<span class="c1"># 4. IoT device communication (common ports)</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 1883 or port 8883 or port 5683&#39;</span><span class="w"> </span>-w<span class="w"> </span>iot_traffic.pcap<span class="w"> </span>-c<span class="w"> </span><span class="m">100</span>
</code></pre></div>
<h4 id="task-3-real-time-protocol-analysis-with-tshark">Task 3: Real-time Protocol Analysis with tshark<a class="headerlink" href="#task-3-real-time-protocol-analysis-with-tshark" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Real-time protocol statistics</span>
tshark<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span>-q<span class="w"> </span>-z<span class="w"> </span>conv,ip<span class="w"> </span>-a<span class="w"> </span>duration:60

<span class="c1"># Real-time HTTP analysis</span>
tshark<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;http&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>ip.src<span class="w"> </span>-e<span class="w"> </span>ip.dst<span class="w"> </span>-e<span class="w"> </span>http.host<span class="w"> </span>-e<span class="w"> </span>http.request.uri

<span class="c1"># Real-time DNS analysis</span>
tshark<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span>-Y<span class="w"> </span><span class="s2">&quot;dns&quot;</span><span class="w"> </span>-T<span class="w"> </span>fields<span class="w"> </span>-e<span class="w"> </span>ip.src<span class="w"> </span>-e<span class="w"> </span>dns.qry.name<span class="w"> </span>-e<span class="w"> </span>dns.resp.addr
</code></pre></div>
<h3 id="network-protocol-understanding-exercises">üìä Network Protocol Understanding Exercises<a class="headerlink" href="#network-protocol-understanding-exercises" title="Permanent link">&para;</a></h3>
<h4 id="exercise-1-tcp-three-way-handshake-analysis">Exercise 1: TCP Three-Way Handshake Analysis<a class="headerlink" href="#exercise-1-tcp-three-way-handshake-analysis" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Capture TCP handshake</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;tcp[tcpflags] &amp; (tcp-syn|tcp-ack) != 0&#39;</span><span class="w"> </span>-w<span class="w"> </span>handshake.pcap<span class="w"> </span>-c<span class="w"> </span><span class="m">20</span>

<span class="c1"># Generate some TCP connections</span>
curl<span class="w"> </span>-s<span class="w"> </span>http://httpbin.org/get<span class="w"> </span>&gt;<span class="w"> </span>/dev/null
wget<span class="w"> </span>-q<span class="w"> </span>-O<span class="w"> </span>/dev/null<span class="w"> </span>http://httpbin.org/json
</code></pre></div>
<p><strong>Wireshark Analysis Steps:</strong>
1. Open <code>handshake.pcap</code> in Wireshark
2. Filter: <code>tcp.flags.syn==1</code>
3. Follow TCP stream for complete handshake
4. Identify: SYN ‚Üí SYN-ACK ‚Üí ACK sequence
5. Note sequence numbers and window sizes</p>
<h4 id="exercise-2-http-vs-https-traffic-comparison">Exercise 2: HTTP vs HTTPS Traffic Comparison<a class="headerlink" href="#exercise-2-http-vs-https-traffic-comparison" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Capture mixed HTTP/HTTPS traffic</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 80 or port 443&#39;</span><span class="w"> </span>-w<span class="w"> </span>http_vs_https.pcap<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># Generate HTTP traffic</span>
curl<span class="w"> </span>-s<span class="w"> </span>http://httpbin.org/user-agent
curl<span class="w"> </span>-s<span class="w"> </span>http://httpbin.org/headers

<span class="c1"># Generate HTTPS traffic</span>
curl<span class="w"> </span>-s<span class="w"> </span>https://httpbin.org/user-agent
curl<span class="w"> </span>-s<span class="w"> </span>https://httpbin.org/headers

sudo<span class="w"> </span>pkill<span class="w"> </span>tcpdump
</code></pre></div>
<p><strong>Analysis Questions:</strong>
1. Can you read HTTP request headers in plaintext?
2. What do you see in HTTPS packets after the TLS handshake?
3. Compare packet sizes between HTTP and HTTPS
4. Identify TLS version and cipher suites used</p>
<h4 id="exercise-3-dns-resolution-deep-dive">Exercise 3: DNS Resolution Deep Dive<a class="headerlink" href="#exercise-3-dns-resolution-deep-dive" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Capture DNS traffic</span>
sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>any<span class="w"> </span><span class="s1">&#39;port 53&#39;</span><span class="w"> </span>-w<span class="w"> </span>dns_analysis.pcap<span class="w"> </span><span class="p">&amp;</span>

<span class="c1"># Generate various DNS queries</span>
nslookup<span class="w"> </span>google.com
nslookup<span class="w"> </span>-type<span class="o">=</span>MX<span class="w"> </span>google.com
nslookup<span class="w"> </span>-type<span class="o">=</span>AAAA<span class="w"> </span>google.com
dig<span class="w"> </span>@8.8.8.8<span class="w"> </span>nvidia.com
dig<span class="w"> </span>@1.1.1.1<span class="w"> </span>jetson.nvidia.com

sudo<span class="w"> </span>pkill<span class="w"> </span>tcpdump
</code></pre></div>
<p><strong>Wireshark Analysis:</strong>
1. Filter: <code>dns</code>
2. Examine query types (A, AAAA, MX, etc.)
3. Compare response times from different DNS servers
4. Identify recursive vs iterative queries
5. Look for DNS over HTTPS (DoH) traffic on port 443</p>
<h3 id="advanced-monitoring-scripts">üîç Advanced Monitoring Scripts<a class="headerlink" href="#advanced-monitoring-scripts" title="Permanent link">&para;</a></h3>
<h4 id="automated-network-monitoring-script">Automated Network Monitoring Script<a class="headerlink" href="#automated-network-monitoring-script" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># jetson_network_monitor.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="k">class</span><span class="w"> </span><span class="nc">JetsonNetworkMonitor</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">capture_duration</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capture_duration</span> <span class="o">=</span> <span class="n">capture_duration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;protocols&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;top_talkers&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s2">&quot;bandwidth_usage&quot;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">capture_packets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Capture packets using tcpdump&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;tcpdump&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
            <span class="s2">&quot;-w&quot;</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span>
            <span class="s2">&quot;-G&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">capture_duration</span><span class="p">),</span>
            <span class="s2">&quot;-W&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">capture_duration</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Capture completed&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_protocols</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcap_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze protocols using tshark&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;tshark&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">pcap_file</span><span class="p">,</span>
            <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;prot,colinfo&quot;</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Parse protocol statistics</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
                    <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
                        <span class="n">protocol</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">count</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;protocols&quot;</span><span class="p">][</span><span class="n">protocol</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Protocol analysis error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_bandwidth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Monitor real-time bandwidth usage&quot;&quot;&quot;</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

        <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">capture_duration</span><span class="p">:</span>
            <span class="n">net_io</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_io_counters</span><span class="p">()</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;bandwidth_usage&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
                <span class="s2">&quot;bytes_sent&quot;</span><span class="p">:</span> <span class="n">net_io</span><span class="o">.</span><span class="n">bytes_sent</span><span class="p">,</span>
                <span class="s2">&quot;bytes_recv&quot;</span><span class="p">:</span> <span class="n">net_io</span><span class="o">.</span><span class="n">bytes_recv</span><span class="p">,</span>
                <span class="s2">&quot;packets_sent&quot;</span><span class="p">:</span> <span class="n">net_io</span><span class="o">.</span><span class="n">packets_sent</span><span class="p">,</span>
                <span class="s2">&quot;packets_recv&quot;</span><span class="p">:</span> <span class="n">net_io</span><span class="o">.</span><span class="n">packets_recv</span>
            <span class="p">})</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Sample every 5 seconds</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_top_talkers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pcap_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify top talking hosts&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;tshark&quot;</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">pcap_file</span><span class="p">,</span>
            <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;-z&quot;</span><span class="p">,</span> <span class="s2">&quot;conv,ip&quot;</span>
        <span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="c1"># Parse conversation statistics</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;&lt;-&gt;&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">6</span><span class="p">:</span>
                        <span class="n">src_ip</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">dst_ip</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                        <span class="n">bytes_total</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

                        <span class="n">conversation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">src_ip</span><span class="si">}</span><span class="s2"> &lt;-&gt; </span><span class="si">{</span><span class="n">dst_ip</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s2">&quot;top_talkers&quot;</span><span class="p">][</span><span class="n">conversation</span><span class="p">]</span> <span class="o">=</span> <span class="n">bytes_total</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Top talkers analysis error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run complete monitoring session&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting network monitoring on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">capture_duration</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>

        <span class="c1"># Start bandwidth monitoring in background</span>
        <span class="n">bandwidth_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">monitor_bandwidth</span><span class="p">)</span>
        <span class="n">bandwidth_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="c1"># Capture packets</span>
        <span class="n">pcap_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;jetson_capture_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="si">}</span><span class="s2">.pcap&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">capture_packets</span><span class="p">(</span><span class="n">pcap_file</span><span class="p">)</span>

        <span class="c1"># Wait for bandwidth monitoring to complete</span>
        <span class="n">bandwidth_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

        <span class="c1"># Analyze captured data</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analyzing captured packets...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_protocols</span><span class="p">(</span><span class="n">pcap_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_top_talkers</span><span class="p">(</span><span class="n">pcap_file</span><span class="p">)</span>

        <span class="c1"># Save results</span>
        <span class="n">results_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;network_analysis_</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="si">}</span><span class="s2">.json&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">results_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysis complete. Results saved to </span><span class="si">{</span><span class="n">results_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Packet capture saved to </span><span class="si">{</span><span class="n">pcap_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="n">JetsonNetworkMonitor</span><span class="p">(</span><span class="n">interface</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">,</span> <span class="n">capture_duration</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">monitor</span><span class="o">.</span><span class="n">run_monitoring</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Network Analysis Summary ===&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Protocols detected: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;protocols&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total conversations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;top_talkers&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monitoring duration: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;bandwidth_usage&#39;</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</code></pre></div>
<h4 id="real-time-protocol-dashboard">Real-time Protocol Dashboard<a class="headerlink" href="#real-time-protocol-dashboard" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># protocol_dashboard.py</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">curses</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ProtocolDashboard</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="o">=</span><span class="s2">&quot;any&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protocol_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">packet_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">packet_capture_worker</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Background packet capture and analysis&quot;&quot;&quot;</span>
        <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;tshark&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span>
            <span class="s2">&quot;-T&quot;</span><span class="p">,</span> <span class="s2">&quot;fields&quot;</span><span class="p">,</span> <span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="s2">&quot;frame.protocols&quot;</span><span class="p">,</span>
            <span class="s2">&quot;-l&quot;</span>  <span class="c1"># Line buffered output</span>
        <span class="p">]</span>

        <span class="n">process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> 
                                 <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">protocols</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">protocol</span> <span class="ow">in</span> <span class="n">protocols</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">protocol</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">protocol_counts</span><span class="p">[</span><span class="n">protocol</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">packet_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
                        <span class="s1">&#39;protocols&#39;</span><span class="p">:</span> <span class="n">protocols</span>
                    <span class="p">})</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">display_dashboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stdscr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display real-time dashboard using curses&quot;&quot;&quot;</span>
        <span class="n">curses</span><span class="o">.</span><span class="n">curs_set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Hide cursor</span>
        <span class="n">stdscr</span><span class="o">.</span><span class="n">nodelay</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="c1"># Non-blocking input</span>

        <span class="c1"># Start packet capture in background</span>
        <span class="n">capture_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">packet_capture_worker</span><span class="p">)</span>
        <span class="n">capture_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">capture_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="c1"># Header</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Jetson Network Protocol Dashboard&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">A_BOLD</span><span class="p">)</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Interface: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">A_UNDERLINE</span><span class="p">)</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Time: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>

            <span class="c1"># Protocol statistics</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Protocol Statistics:&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">A_BOLD</span><span class="p">)</span>
            <span class="n">row</span> <span class="o">=</span> <span class="mi">5</span>

            <span class="c1"># Sort protocols by count</span>
            <span class="n">sorted_protocols</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol_counts</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> 
                                    <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sorted_protocols</span><span class="p">[:</span><span class="mi">15</span><span class="p">]:</span>  <span class="c1"># Top 15</span>
                <span class="n">bar_length</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">count</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span> <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
                <span class="n">bar</span> <span class="o">=</span> <span class="s2">&quot;‚ñà&quot;</span> <span class="o">*</span> <span class="n">bar_length</span>
                <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">protocol</span><span class="si">:</span><span class="s2">15</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">count</span><span class="si">:</span><span class="s2">6</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">bar</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="c1"># Recent activity</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Recent Activity:&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">A_BOLD</span><span class="p">)</span>
            <span class="n">recent_packets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">packet_history</span><span class="p">)[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>  <span class="c1"># Last 10 packets</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">packet</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">recent_packets</span><span class="p">):</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">,</span> 
                                        <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]))</span>
                <span class="n">protocols_str</span> <span class="o">=</span> <span class="s1">&#39; -&gt; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">packet</span><span class="p">[</span><span class="s1">&#39;protocols&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>  <span class="c1"># First 5 protocols</span>
                <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">protocols_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">stdscr</span><span class="o">.</span><span class="n">addstr</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Press &#39;q&#39; to quit&quot;</span><span class="p">,</span> <span class="n">curses</span><span class="o">.</span><span class="n">A_DIM</span><span class="p">)</span>
            <span class="n">stdscr</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>

            <span class="c1"># Check for quit</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">stdscr</span><span class="o">.</span><span class="n">getch</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">dashboard</span> <span class="o">=</span> <span class="n">ProtocolDashboard</span><span class="p">()</span>
    <span class="n">curses</span><span class="o">.</span><span class="n">wrapper</span><span class="p">(</span><span class="n">dashboard</span><span class="o">.</span><span class="n">display_dashboard</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
<h3 id="comprehensive-lab-deliverables">üìã Comprehensive Lab Deliverables<a class="headerlink" href="#comprehensive-lab-deliverables" title="Permanent link">&para;</a></h3>
<h4 id="part-1-container-setup-20-points">Part 1: Container Setup (20 points)<a class="headerlink" href="#part-1-container-setup-20-points" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Successfully run Wireshark in Docker container without sudo</li>
<li class="task-list-item"><input type="checkbox" disabled/> Capture packets from at least 2 different network interfaces</li>
<li class="task-list-item"><input type="checkbox" disabled/> Screenshot of containerized Wireshark interface</li>
</ul>
<h4 id="part-2-protocol-analysis-30-points">Part 2: Protocol Analysis (30 points)<a class="headerlink" href="#part-2-protocol-analysis-30-points" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Analyze TCP three-way handshake with sequence numbers</li>
<li class="task-list-item"><input type="checkbox" disabled/> Compare HTTP vs HTTPS packet contents</li>
<li class="task-list-item"><input type="checkbox" disabled/> Identify at least 5 different protocols in your captures</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document DNS resolution process with timing analysis</li>
</ul>
<h4 id="part-3-advanced-monitoring-25-points">Part 3: Advanced Monitoring (25 points)<a class="headerlink" href="#part-3-advanced-monitoring-25-points" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Run the automated monitoring script for 5 minutes</li>
<li class="task-list-item"><input type="checkbox" disabled/> Generate network analysis JSON report</li>
<li class="task-list-item"><input type="checkbox" disabled/> Identify top 3 network conversations</li>
<li class="task-list-item"><input type="checkbox" disabled/> Create protocol distribution chart</li>
</ul>
<h4 id="part-4-real-time-dashboard-15-points">Part 4: Real-time Dashboard (15 points)<a class="headerlink" href="#part-4-real-time-dashboard-15-points" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Run the protocol dashboard for 2 minutes</li>
<li class="task-list-item"><input type="checkbox" disabled/> Screenshot showing real-time protocol statistics</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document any unusual or interesting traffic patterns</li>
</ul>
<h4 id="part-5-security-analysis-10-points">Part 5: Security Analysis (10 points)<a class="headerlink" href="#part-5-security-analysis-10-points" title="Permanent link">&para;</a></h4>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Identify any unencrypted sensitive data in captures</li>
<li class="task-list-item"><input type="checkbox" disabled/> Document potential security concerns observed</li>
<li class="task-list-item"><input type="checkbox" disabled/> Suggest improvements for network security</li>
</ul>
<h3 id="advanced-challenge-iot-device-analysis">üéØ Advanced Challenge: IoT Device Analysis<a class="headerlink" href="#advanced-challenge-iot-device-analysis" title="Permanent link">&para;</a></h3>
<p><strong>Scenario</strong>: Your Jetson is connected to a network with various IoT devices.</p>
<p><strong>Tasks</strong>:
1. Identify IoT devices by their traffic patterns
2. Analyze MQTT, CoAP, or other IoT protocols
3. Create a device fingerprinting report
4. Implement automated anomaly detection</p>
<p><strong>Bonus</strong>: Integrate with NVIDIA DeepStream for AI-powered network analysis</p>
<h3 id="report-template">üìù Report Template<a class="headerlink" href="#report-template" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="gh"># Jetson Network Analysis Report</span>

<span class="gu">## Executive Summary</span>
<span class="k">-</span><span class="w"> </span>Monitoring duration: X minutes
<span class="k">-</span><span class="w"> </span>Total packets captured: X
<span class="k">-</span><span class="w"> </span>Unique protocols identified: X
<span class="k">-</span><span class="w"> </span>Security findings: X

<span class="gu">## Network Overview</span>
<span class="k">-</span><span class="w"> </span>Primary interface: 
<span class="k">-</span><span class="w"> </span>IP configuration:
<span class="k">-</span><span class="w"> </span>Gateway and DNS servers:

<span class="gu">## Protocol Analysis</span>
<span class="gu">### Most Common Protocols</span>
<span class="k">1.</span> Protocol A (X% of traffic)
<span class="k">2.</span> Protocol B (X% of traffic)
<span class="k">3.</span> Protocol C (X% of traffic)

<span class="gu">### Interesting Findings</span>
<span class="k">-</span><span class="w"> </span>Unusual protocols detected:
<span class="k">-</span><span class="w"> </span>Potential security concerns:
<span class="k">-</span><span class="w"> </span>Performance bottlenecks:

<span class="gu">## Container Performance</span>
<span class="k">-</span><span class="w"> </span>Wireshark container resource usage:
<span class="k">-</span><span class="w"> </span>Capture performance comparison:
<span class="k">-</span><span class="w"> </span>Recommendations:

<span class="gu">## Conclusions and Recommendations</span>
<span class="k">-</span><span class="w"> </span>Network optimization suggestions:
<span class="k">-</span><span class="w"> </span>Security improvements:
<span class="k">-</span><span class="w"> </span>Future monitoring strategies:
</code></pre></div>
<p>This comprehensive lab provides hands-on experience with advanced network analysis on Jetson devices, emphasizing containerized tools, protocol understanding, and practical security analysis.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>