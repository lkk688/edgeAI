
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>üõ°Ô∏è 01d: Advanced Linux Cyber Defense on Jetson - Jetson Cyber & AI Summer Camp</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#01d-advanced-linux-cyber-defense-on-jetson" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Jetson Cyber &amp; AI Summer Camp" class="md-header__button md-logo" aria-label="Jetson Cyber & AI Summer Camp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jetson Cyber & AI Summer Camp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              üõ°Ô∏è 01d: Advanced Linux Cyber Defense on Jetson
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jetson Cyber &amp; AI Summer Camp" class="md-nav__button md-logo" aria-label="Jetson Cyber & AI Summer Camp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Jetson Cyber & AI Summer Camp
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üî∞ Getting Started with Jetson
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üî∞ Getting Started with Jetson
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00_sjsujetsontool_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚úÖ sjsujetsontool Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00b_sjsujetsontool_cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìã sjsujetsontool Cheatsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01a_nvidia_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîß Introduction to NVIDIA Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01b_jetson_cuda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ CUDA Programming on Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üêß Linux Fundamentals
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üêß Linux Fundamentals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02a_linux_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üí° Linux OS Basics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03a_linux_networking_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üåê Linux Networking Tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ü§ñ AI & LLM
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ü§ñ AI & LLM
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04_deeplearning_cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üß† Deep Learning & CNN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05_transformers_nlp_applications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üß† Transformers & NLP Applications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06_llms_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üöÄ Large Language Models on Jetson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07_nlp_applications_llm_optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üìö NLP Applications & LLM Optimization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08_prompt_engineering_langchain_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ‚úçÔ∏è Prompt Engineering & LangChain
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09_rag_app_langchain_jetson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üîé RAG Applications with LangChain
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Learning Objectives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-security-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      üß± Basic Security Concepts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-linux-defense-tools" class="md-nav__link">
    <span class="md-ellipsis">
      üîß Core Linux Defense Tools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîß Core Linux Defense Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-ufw-uncomplicated-firewall" class="md-nav__link">
    <span class="md-ellipsis">
      üîí 1. ufw ‚Äì Uncomplicated Firewall
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-iptables-advanced-packet-filtering-optional-advanced" class="md-nav__link">
    <span class="md-ellipsis">
      üî• 2. iptables ‚Äì Advanced Packet Filtering (optional, advanced)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-auditd-audit-daemon" class="md-nav__link">
    <span class="md-ellipsis">
      üìú 3. auditd ‚Äì Audit Daemon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-fail2ban-prevent-brute-force-logins" class="md-nav__link">
    <span class="md-ellipsis">
      üö´ 4. fail2ban ‚Äì Prevent Brute Force Logins
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-chkrootkit-rootkit-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ 5. chkrootkit ‚Äì Rootkit Scanner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-clamav-open-source-antivirus" class="md-nav__link">
    <span class="md-ellipsis">
      üß† 6. clamav ‚Äì Open-Source Antivirus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-monitoring-tools" class="md-nav__link">
    <span class="md-ellipsis">
      üîç System Monitoring Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-harden-and-monitor-a-jetson-device" class="md-nav__link">
    <span class="md-ellipsis">
      üì¶ Lab: Harden and Monitor a Jetson Device
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üì¶ Lab: Harden and Monitor a Jetson Device">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-by-step" class="md-nav__link">
    <span class="md-ellipsis">
      Step-by-Step:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#best-practices-recap" class="md-nav__link">
    <span class="md-ellipsis">
      üö® Best Practices Recap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#challenge-for-students" class="md-nav__link">
    <span class="md-ellipsis">
      üß† Challenge for Students
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#containerized-security-environment-setup" class="md-nav__link">
    <span class="md-ellipsis">
      üê≥ Containerized Security Environment Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üê≥ Containerized Security Environment Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-container-base-image" class="md-nav__link">
    <span class="md-ellipsis">
      Security Container Base Image
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-and-run-security-container" class="md-nav__link">
    <span class="md-ellipsis">
      Build and Run Security Container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-jetson-security-hardening" class="md-nav__link">
    <span class="md-ellipsis">
      üîê Advanced Jetson Security Hardening
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîê Advanced Jetson Security Hardening">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-container-based-firewall-management" class="md-nav__link">
    <span class="md-ellipsis">
      1. Container-Based Firewall Management
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-advanced-threat-detection-system" class="md-nav__link">
    <span class="md-ellipsis">
      2. Advanced Threat Detection System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-iot-device-security-scanner" class="md-nav__link">
    <span class="md-ellipsis">
      3. IoT Device Security Scanner
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-cybersecurity-lab-exercises" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Advanced Cybersecurity Lab Exercises
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ Advanced Cybersecurity Lab Exercises">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lab-1-container-based-security-monitoring" class="md-nav__link">
    <span class="md-ellipsis">
      Lab 1: Container-Based Security Monitoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-2-iot-device-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      Lab 2: IoT Device Security Assessment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lab-3-incident-response-automation" class="md-nav__link">
    <span class="md-ellipsis">
      Lab 3: Incident Response Automation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-security-hardening-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      üîí Advanced Security Hardening Checklist
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîí Advanced Security Hardening Checklist">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jetson-specific-security-measures" class="md-nav__link">
    <span class="md-ellipsis">
      Jetson-Specific Security Measures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-incident-response-playbook" class="md-nav__link">
    <span class="md-ellipsis">
      üö® Security Incident Response Playbook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üö® Security Incident Response Playbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-detection-phase" class="md-nav__link">
    <span class="md-ellipsis">
      1. Detection Phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-analysis-phase" class="md-nav__link">
    <span class="md-ellipsis">
      2. Analysis Phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-containment-phase" class="md-nav__link">
    <span class="md-ellipsis">
      3. Containment Phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-eradication-phase" class="md-nav__link">
    <span class="md-ellipsis">
      4. Eradication Phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-recovery-phase" class="md-nav__link">
    <span class="md-ellipsis">
      5. Recovery Phase
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-lessons-learned" class="md-nav__link">
    <span class="md-ellipsis">
      6. Lessons Learned
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#final-challenge-comprehensive-security-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      üéì Final Challenge: Comprehensive Security Assessment
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="01d-advanced-linux-cyber-defense-on-jetson">üõ°Ô∏è 01d: Advanced Linux Cyber Defense on Jetson<a class="headerlink" href="#01d-advanced-linux-cyber-defense-on-jetson" title="Permanent link">&para;</a></h1>
<p>This module introduces comprehensive cyber defense concepts specifically tailored for Jetson devices, covering containerized security tools, advanced threat detection, and edge-specific hardening techniques. Students will learn to implement robust cybersecurity measures using container-based approaches that don't require sudo access.</p>
<hr />
<h2 id="learning-objectives">üéØ Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<ul>
<li>Master advanced cyber defense strategies on Jetson Linux systems</li>
<li>Implement containerized security tools: <code>ufw</code>, <code>iptables</code>, <code>auditd</code>, <code>fail2ban</code>, <code>chkrootkit</code>, etc.</li>
<li>Deploy edge-specific threat detection and monitoring systems</li>
<li>Practice defensive monitoring and system hardening in container environments</li>
<li>Understand IoT/Edge device security challenges and mitigation strategies</li>
<li>Implement automated security monitoring and incident response</li>
</ul>
<hr />
<h2 id="basic-security-concepts">üß± Basic Security Concepts<a class="headerlink" href="#basic-security-concepts" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Concept</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Principle of Least Privilege</td>
<td>Only grant minimal necessary access to users/programs</td>
</tr>
<tr>
<td>System Hardening</td>
<td>Reduce attack surface by disabling unused services, setting strong permissions</td>
</tr>
<tr>
<td>Logging &amp; Auditing</td>
<td>Track changes, log events, monitor system activities</td>
</tr>
<tr>
<td>Real-Time Protection</td>
<td>Monitor services, detect intrusions, block malicious behavior</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="core-linux-defense-tools">üîß Core Linux Defense Tools<a class="headerlink" href="#core-linux-defense-tools" title="Permanent link">&para;</a></h2>
<p>ufw, fail2ban, and auditd (which require host-level access or systemd)</p>
<h3 id="1-ufw-uncomplicated-firewall">üîí 1. <code>ufw</code> ‚Äì Uncomplicated Firewall<a class="headerlink" href="#1-ufw-uncomplicated-firewall" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>ufw
sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span>
sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>ssh
sudo<span class="w"> </span>ufw<span class="w"> </span>status<span class="w"> </span>verbose
</code></pre></div>
<h3 id="2-iptables-advanced-packet-filtering-optional-advanced">üî• 2. <code>iptables</code> ‚Äì Advanced Packet Filtering (optional, advanced)<a class="headerlink" href="#2-iptables-advanced-packet-filtering-optional-advanced" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>iptables<span class="w"> </span>-L
sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">22</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
sudo<span class="w"> </span>iptables<span class="w"> </span>-A<span class="w"> </span>INPUT<span class="w"> </span>-j<span class="w"> </span>DROP
</code></pre></div>
<h3 id="3-auditd-audit-daemon">üìú 3. <code>auditd</code> ‚Äì Audit Daemon<a class="headerlink" href="#3-auditd-audit-daemon" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>auditd<span class="w"> </span>audispd-plugins
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>auditd
sudo<span class="w"> </span>auditctl<span class="w"> </span>-w<span class="w"> </span>/etc/passwd<span class="w"> </span>-p<span class="w"> </span>war<span class="w"> </span>-k<span class="w"> </span>passwd_monitor
sudo<span class="w"> </span>ausearch<span class="w"> </span>-k<span class="w"> </span>passwd_monitor
</code></pre></div>
<h3 id="4-fail2ban-prevent-brute-force-logins">üö´ 4. <code>fail2ban</code> ‚Äì Prevent Brute Force Logins<a class="headerlink" href="#4-fail2ban-prevent-brute-force-logins" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>fail2ban
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>fail2ban
sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>fail2ban
</code></pre></div>
<ul>
<li>Config file: <code>/etc/fail2ban/jail.conf</code></li>
</ul>
<h3 id="5-chkrootkit-rootkit-scanner">üß™ 5. <code>chkrootkit</code> ‚Äì Rootkit Scanner<a class="headerlink" href="#5-chkrootkit-rootkit-scanner" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>chkrootkit
sudo<span class="w"> </span>chkrootkit
</code></pre></div>
<h3 id="6-clamav-open-source-antivirus">üß† 6. <code>clamav</code> ‚Äì Open-Source Antivirus<a class="headerlink" href="#6-clamav-open-source-antivirus" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>clamav
sudo<span class="w"> </span>freshclam<span class="w">  </span><span class="c1"># update definitions</span>
sudo<span class="w"> </span>clamscan<span class="w"> </span>-r<span class="w"> </span>/home
</code></pre></div>
<hr />
<h2 id="system-monitoring-tools">üîç System Monitoring Tools<a class="headerlink" href="#system-monitoring-tools" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>top</code>, <code>htop</code></td>
<td>View running processes</td>
</tr>
<tr>
<td><code>netstat</code>, <code>ss</code></td>
<td>View open network connections</td>
</tr>
<tr>
<td><code>who</code>, <code>w</code></td>
<td>Who is logged in</td>
</tr>
<tr>
<td><code>journalctl</code></td>
<td>System logs</td>
</tr>
<tr>
<td><code>ps aux</code></td>
<td>View all running processes</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="lab-harden-and-monitor-a-jetson-device">üì¶ Lab: Harden and Monitor a Jetson Device<a class="headerlink" href="#lab-harden-and-monitor-a-jetson-device" title="Permanent link">&para;</a></h2>
<h3 id="objective">Objective:<a class="headerlink" href="#objective" title="Permanent link">&para;</a></h3>
<p>Set up basic cyber defense on a Jetson Linux device and test protections.</p>
<h3 id="step-by-step">Step-by-Step:<a class="headerlink" href="#step-by-step" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Update and Harden:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt<span class="w"> </span>upgrade
sudo<span class="w"> </span>ufw<span class="w"> </span><span class="nb">enable</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>ufw<span class="w"> </span>allow<span class="w"> </span>ssh
</code></pre></div>
<ol>
<li><strong>Install and Configure <code>fail2ban</code>:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>fail2ban
</code></pre></div>
<ol>
<li><strong>Simulate SSH brute force attack (from another machine):</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>hydra<span class="w"> </span>-l<span class="w"> </span>pi<span class="w"> </span>-P<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>ssh://&lt;JETSON-IP&gt;
</code></pre></div>
<p>Monitor ban via:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>fail2ban-client<span class="w"> </span>status<span class="w"> </span>sshd
</code></pre></div>
<ol>
<li><strong>Monitor System Logs:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-xe
</code></pre></div>
<ol>
<li><strong>Run <code>chkrootkit</code>:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chkrootkit
</code></pre></div>
<ol>
<li><strong>Enable Auditing:</strong></li>
</ol>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>auditctl<span class="w"> </span>-w<span class="w"> </span>/etc/shadow<span class="w"> </span>-p<span class="w"> </span>wa<span class="w"> </span>-k<span class="w"> </span>shadow_watch
</code></pre></div>
<hr />
<h2 id="best-practices-recap">üö® Best Practices Recap<a class="headerlink" href="#best-practices-recap" title="Permanent link">&para;</a></h2>
<ul>
<li>Keep system updated regularly</li>
<li>Disable unused services and ports</li>
<li>Use firewalls (<code>ufw</code>/<code>iptables</code>)</li>
<li>Log and monitor all activity</li>
<li>Use strong, unique passwords</li>
<li>Never run user applications as root</li>
</ul>
<hr />
<h2 id="challenge-for-students">üß† Challenge for Students<a class="headerlink" href="#challenge-for-students" title="Permanent link">&para;</a></h2>
<p>üí° Try hardening your Jetson and writing a bash script that installs and configures <code>ufw</code>, <code>fail2ban</code>, <code>auditd</code>, and runs a periodic system check.</p>
<p>üèÅ Bonus: Set up email alerts for intrusion logs.</p>
<hr />
<hr />
<h2 id="containerized-security-environment-setup">üê≥ Containerized Security Environment Setup<a class="headerlink" href="#containerized-security-environment-setup" title="Permanent link">&para;</a></h2>
<h3 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ensure Docker is installed and running</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>docker
sudo<span class="w"> </span>usermod<span class="w"> </span>-aG<span class="w"> </span>docker<span class="w"> </span><span class="nv">$USER</span>
<span class="c1"># Log out and back in for group changes to take effect</span>
</code></pre></div>
<h3 id="security-container-base-image">Security Container Base Image<a class="headerlink" href="#security-container-base-image" title="Permanent link">&para;</a></h3>
<p>Create a comprehensive security toolkit container:</p>
<div class="highlight"><pre><span></span><code><span class="c"># Dockerfile.security-toolkit</span>
<span class="k">FROM</span><span class="w"> </span><span class="s">ubuntu:22.04</span>

<span class="c"># Install security tools</span>
<span class="k">RUN</span><span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ufw<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>iptables<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>fail2ban<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>chkrootkit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>clamav<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>auditd<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>rkhunter<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>lynis<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>nmap<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>tcpdump<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wireshark-common<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>tshark<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>netstat-nat<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ss<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>htop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>iotop<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>strace<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>ltrace<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>gdb<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>python3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>python3-pip<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>curl<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>wget<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>git<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>vim<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>nano<span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>/var/lib/apt/lists/*

<span class="c"># Install Python security libraries</span>
<span class="k">RUN</span><span class="w"> </span>pip3<span class="w"> </span>install<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>scapy<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>psutil<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>requests<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>beautifulsoup4<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>paramiko<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>cryptography<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>pycryptodome<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>yara-python<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>volatility3<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bandit<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>safety

<span class="c"># Create non-root user for security operations</span>
<span class="k">RUN</span><span class="w"> </span>useradd<span class="w"> </span>-m<span class="w"> </span>-s<span class="w"> </span>/bin/bash<span class="w"> </span>secops<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>usermod<span class="w"> </span>-aG<span class="w"> </span>sudo<span class="w"> </span>secops

<span class="c"># Set up working directory</span>
<span class="k">WORKDIR</span><span class="w"> </span><span class="s">/home/secops</span>
<span class="k">USER</span><span class="w"> </span><span class="s">secops</span>

<span class="k">CMD</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;/bin/bash&quot;</span><span class="p">]</span>
</code></pre></div>
<h3 id="build-and-run-security-container">Build and Run Security Container<a class="headerlink" href="#build-and-run-security-container" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Build the security toolkit container</span>
docker<span class="w"> </span>build<span class="w"> </span>-f<span class="w"> </span>Dockerfile.security-toolkit<span class="w"> </span>-t<span class="w"> </span>jetson-security:latest<span class="w"> </span>.

<span class="c1"># Run with network and capability privileges for security tools</span>
docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>jetson-security<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>host<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cap-add<span class="w"> </span>NET_ADMIN<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cap-add<span class="w"> </span>NET_RAW<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cap-add<span class="w"> </span>SYS_PTRACE<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/var/log:/host/var/log:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/proc:/host/proc:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>/sys:/host/sys:ro<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>/security-data:/home/secops/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>jetson-security:latest
</code></pre></div>
<hr />
<h2 id="advanced-jetson-security-hardening">üîê Advanced Jetson Security Hardening<a class="headerlink" href="#advanced-jetson-security-hardening" title="Permanent link">&para;</a></h2>
<h3 id="1-container-based-firewall-management">1. Container-Based Firewall Management<a class="headerlink" href="#1-container-based-firewall-management" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># jetson_firewall_manager.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>

<span class="k">class</span><span class="w"> </span><span class="nc">JetsonFirewallManager</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_logging</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules_file</span> <span class="o">=</span> <span class="s2">&quot;/home/secops/data/firewall_rules.json&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;/home/secops/data/firewall.log&#39;</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_network_interfaces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get all network interfaces on Jetson&quot;&quot;&quot;</span>
        <span class="n">interfaces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">interface</span><span class="p">,</span> <span class="n">addrs</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_if_addrs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">interface</span> <span class="o">!=</span> <span class="s1">&#39;lo&#39;</span><span class="p">:</span>  <span class="c1"># Skip loopback</span>
                <span class="n">interfaces</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">interface</span><span class="p">,</span>
                    <span class="s1">&#39;addresses&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">addr</span><span class="o">.</span><span class="n">address</span> <span class="k">for</span> <span class="n">addr</span> <span class="ow">in</span> <span class="n">addrs</span><span class="p">]</span>
                <span class="p">})</span>
        <span class="k">return</span> <span class="n">interfaces</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_iot_firewall_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create IoT-specific firewall rules for Jetson&quot;&quot;&quot;</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;rules&#39;</span><span class="p">:</span> <span class="p">[</span>
                <span class="c1"># Allow SSH (secure management)</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;SSH access&#39;</span><span class="p">},</span>

                <span class="c1"># IoT Communication Ports</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">1883</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;MQTT&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">8883</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;MQTT over SSL&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">5683</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;udp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;CoAP&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">5684</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;udp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;CoAP over DTLS&#39;</span><span class="p">},</span>

                <span class="c1"># Web services</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;HTTP&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;allow&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">443</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;HTTPS&#39;</span><span class="p">},</span>

                <span class="c1"># Block common attack ports</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;deny&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Telnet&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;deny&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">135</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;RPC&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;deny&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">445</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;SMB&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;deny&#39;</span><span class="p">,</span> <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="mi">3389</span><span class="p">,</span> <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;tcp&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;RDP&#39;</span><span class="p">},</span>
            <span class="p">]</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rules</span><span class="p">[</span><span class="s1">&#39;rules&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> firewall rules&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rules</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_iptables_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply iptables rules (requires container with NET_ADMIN capability)&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Flush existing rules</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-F&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-X&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Set default policies</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-P&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;DROP&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-P&#39;</span><span class="p">,</span> <span class="s1">&#39;FORWARD&#39;</span><span class="p">,</span> <span class="s1">&#39;DROP&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-P&#39;</span><span class="p">,</span> <span class="s1">&#39;OUTPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEPT&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Allow loopback</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;lo&#39;</span><span class="p">,</span> <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEPT&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Allow established connections</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;-m&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;--state&#39;</span><span class="p">,</span> <span class="s1">&#39;ESTABLISHED,RELATED&#39;</span><span class="p">,</span> <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEPT&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Apply custom rules</span>
            <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">[</span><span class="s1">&#39;rules&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;allow&#39;</span><span class="p">:</span>
                    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">],</span> <span class="s1">&#39;--dport&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]),</span> <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEPT&#39;</span><span class="p">]</span>
                    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applied allow rule: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;deny&#39;</span><span class="p">:</span>
                    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">rule</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">],</span> <span class="s1">&#39;--dport&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]),</span> <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;DROP&#39;</span><span class="p">]</span>
                    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applied deny rule: </span><span class="si">{</span><span class="n">rule</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;All firewall rules applied successfully&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to apply iptables rules: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">monitor_connections</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Monitor active network connections&quot;&quot;&quot;</span>
        <span class="n">connections</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_connections</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;inet&#39;</span><span class="p">)</span>
        <span class="n">active_connections</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">connections</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;ESTABLISHED&#39;</span><span class="p">:</span>
                <span class="n">active_connections</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;local_address&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                    <span class="s1">&#39;remote_address&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">raddr</span> <span class="k">else</span> <span class="s2">&quot;N/A&quot;</span><span class="p">,</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">status</span><span class="p">,</span>
                    <span class="s1">&#39;pid&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">pid</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">active_connections</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">firewall</span> <span class="o">=</span> <span class="n">JetsonFirewallManager</span><span class="p">()</span>

    <span class="c1"># Get network interfaces</span>
    <span class="n">interfaces</span> <span class="o">=</span> <span class="n">firewall</span><span class="o">.</span><span class="n">get_network_interfaces</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Network interfaces: </span><span class="si">{</span><span class="n">interfaces</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create and apply firewall rules</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">firewall</span><span class="o">.</span><span class="n">create_iot_firewall_rules</span><span class="p">()</span>
    <span class="n">firewall</span><span class="o">.</span><span class="n">apply_iptables_rules</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>

    <span class="c1"># Monitor connections</span>
    <span class="n">connections</span> <span class="o">=</span> <span class="n">firewall</span><span class="o">.</span><span class="n">monitor_connections</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Active connections: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">connections</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="2-advanced-threat-detection-system">2. Advanced Threat Detection System<a class="headerlink" href="#2-advanced-threat-detection-system" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># jetson_threat_detector.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">hashlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">deque</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">queue</span>

<span class="k">class</span><span class="w"> </span><span class="nc">JetsonThreatDetector</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baseline_file</span> <span class="o">=</span> <span class="s2">&quot;/home/secops/data/system_baseline.json&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alerts_file</span> <span class="o">=</span> <span class="s2">&quot;/home/secops/data/security_alerts.json&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alert_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">network_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_integrity_db</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Threat detection thresholds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;cpu_spike&#39;</span><span class="p">:</span> <span class="mf">90.0</span><span class="p">,</span>  <span class="c1"># CPU usage percentage</span>
            <span class="s1">&#39;memory_spike&#39;</span><span class="p">:</span> <span class="mf">85.0</span><span class="p">,</span>  <span class="c1"># Memory usage percentage</span>
            <span class="s1">&#39;network_connections&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Max concurrent connections</span>
            <span class="s1">&#39;process_spawn_rate&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># Processes per minute</span>
            <span class="s1">&#39;failed_login_attempts&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># Failed logins per hour</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_system_baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create baseline of normal system behavior&quot;&quot;&quot;</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;processes&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;network_connections&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;system_files&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;performance_metrics&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="c1"># Baseline processes</span>
        <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">([</span><span class="s1">&#39;pid&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;exe&#39;</span><span class="p">,</span> <span class="s1">&#39;cmdline&#39;</span><span class="p">]):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;processes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">psutil</span><span class="o">.</span><span class="n">NoSuchProcess</span><span class="p">,</span> <span class="n">psutil</span><span class="o">.</span><span class="n">AccessDenied</span><span class="p">):</span>
                <span class="k">continue</span>

        <span class="c1"># Baseline network connections</span>
        <span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;network_connections&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">&#39;local_address&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s1">&#39;remote_address&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="o">.</span><span class="n">ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">raddr</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">status</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_connections</span><span class="p">()</span>
        <span class="p">]</span>

        <span class="c1"># Baseline system files (critical files to monitor)</span>
        <span class="n">critical_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;/etc/passwd&#39;</span><span class="p">,</span> <span class="s1">&#39;/etc/shadow&#39;</span><span class="p">,</span> <span class="s1">&#39;/etc/hosts&#39;</span><span class="p">,</span>
            <span class="s1">&#39;/etc/ssh/sshd_config&#39;</span><span class="p">,</span> <span class="s1">&#39;/etc/sudoers&#39;</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">critical_files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">file_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
                    <span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;system_files&#39;</span><span class="p">][</span><span class="n">file_path</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s1">&#39;hash&#39;</span><span class="p">:</span> <span class="n">file_hash</span><span class="p">,</span>
                        <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">file_path</span><span class="p">),</span>
                        <span class="s1">&#39;mtime&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
                    <span class="p">}</span>

        <span class="c1"># Performance baseline</span>
        <span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;performance_metrics&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;cpu_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">cpu_percent</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="s1">&#39;memory_percent&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">virtual_memory</span><span class="p">()</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;disk_usage&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">disk_usage</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">percent</span><span class="p">,</span>
            <span class="s1">&#39;network_io&#39;</span><span class="p">:</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_io_counters</span><span class="p">()</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System baseline created with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">baseline</span><span class="p">[</span><span class="s1">&#39;processes&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2"> processes&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">baseline</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_anomalous_processes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect suspicious process behavior&quot;&quot;&quot;</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">current_processes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">psutil</span><span class="o">.</span><span class="n">process_iter</span><span class="p">([</span><span class="s1">&#39;pid&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;exe&#39;</span><span class="p">,</span> <span class="s1">&#39;cmdline&#39;</span><span class="p">,</span> <span class="s1">&#39;cpu_percent&#39;</span><span class="p">,</span> <span class="s1">&#39;memory_percent&#39;</span><span class="p">]))</span>

        <span class="c1"># Check for high resource usage</span>
        <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="n">current_processes</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;cpu_percent&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;cpu_spike&#39;</span><span class="p">]:</span>
                    <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;high_cpu_usage&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;process&#39;</span><span class="p">:</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Process </span><span class="si">{</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;cpu_percent&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% CPU&quot;</span>
                    <span class="p">})</span>

                <span class="k">if</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;memory_percent&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;memory_spike&#39;</span><span class="p">]:</span>
                    <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;high_memory_usage&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;process&#39;</span><span class="p">:</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Process </span><span class="si">{</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;memory_percent&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">% memory&quot;</span>
                    <span class="p">})</span>

                <span class="c1"># Check for suspicious process names</span>
                <span class="n">suspicious_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nc&#39;</span><span class="p">,</span> <span class="s1">&#39;netcat&#39;</span><span class="p">,</span> <span class="s1">&#39;ncat&#39;</span><span class="p">,</span> <span class="s1">&#39;socat&#39;</span><span class="p">,</span> <span class="s1">&#39;telnet&#39;</span><span class="p">,</span> <span class="s1">&#39;wget&#39;</span><span class="p">,</span> <span class="s1">&#39;curl&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">suspicious_names</span><span class="p">):</span>
                    <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;suspicious_process&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;process&#39;</span><span class="p">:</span> <span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Potentially suspicious process: </span><span class="si">{</span><span class="n">proc</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">})</span>

            <span class="k">except</span> <span class="p">(</span><span class="n">psutil</span><span class="o">.</span><span class="n">NoSuchProcess</span><span class="p">,</span> <span class="n">psutil</span><span class="o">.</span><span class="n">AccessDenied</span><span class="p">):</span>
                <span class="k">continue</span>

        <span class="k">return</span> <span class="n">alerts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">detect_network_anomalies</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Detect suspicious network activity&quot;&quot;&quot;</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">connections</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">net_connections</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;inet&#39;</span><span class="p">)</span>

        <span class="c1"># Count connections by remote IP</span>
        <span class="n">remote_ips</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">connections</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="p">:</span>
                <span class="n">remote_ips</span><span class="p">[</span><span class="n">conn</span><span class="o">.</span><span class="n">raddr</span><span class="o">.</span><span class="n">ip</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Check for too many connections from single IP</span>
        <span class="k">for</span> <span class="n">ip</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">remote_ips</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># Threshold for suspicious connection count</span>
                <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;multiple_connections&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;remote_ip&#39;</span><span class="p">:</span> <span class="n">ip</span><span class="p">,</span>
                    <span class="s1">&#39;connection_count&#39;</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Multiple connections (</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">) from IP </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">})</span>

        <span class="c1"># Check for connections to suspicious ports</span>
        <span class="n">suspicious_ports</span> <span class="o">=</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">445</span><span class="p">,</span> <span class="mi">1433</span><span class="p">,</span> <span class="mi">3389</span><span class="p">,</span> <span class="mi">5900</span><span class="p">,</span> <span class="mi">6667</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">conn</span> <span class="ow">in</span> <span class="n">connections</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">conn</span><span class="o">.</span><span class="n">laddr</span> <span class="ow">and</span> <span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">port</span> <span class="ow">in</span> <span class="n">suspicious_ports</span><span class="p">:</span>
                <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;suspicious_port&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Connection on suspicious port </span><span class="si">{</span><span class="n">conn</span><span class="o">.</span><span class="n">laddr</span><span class="o">.</span><span class="n">port</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">alerts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_file_integrity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check integrity of critical system files&quot;&quot;&quot;</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_file</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">alerts</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">baseline_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">baseline</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">file_path</span><span class="p">,</span> <span class="n">baseline_info</span> <span class="ow">in</span> <span class="n">baseline</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;system_files&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">current_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">current_hash</span> <span class="o">!=</span> <span class="n">baseline_info</span><span class="p">[</span><span class="s1">&#39;hash&#39;</span><span class="p">]:</span>
                    <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;file_integrity_violation&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;file_path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Critical file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> has been modified&quot;</span>
                    <span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;file_missing&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;file_path&#39;</span><span class="p">:</span> <span class="n">file_path</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Critical file </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2"> is missing&quot;</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">alerts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">analyze_system_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Analyze system logs for security events&quot;&quot;&quot;</span>
        <span class="n">alerts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Check for failed SSH login attempts</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
                <span class="p">[</span><span class="s1">&#39;grep&#39;</span><span class="p">,</span> <span class="s1">&#39;-i&#39;</span><span class="p">,</span> <span class="s1">&#39;failed password&#39;</span><span class="p">,</span> <span class="s1">&#39;/host/var/log/auth.log&#39;</span><span class="p">],</span>
                <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">failed_logins</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">recent_failures</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">failed_logins</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">line</span> <span class="ow">and</span> <span class="s1">&#39;ssh&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                        <span class="n">recent_failures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent_failures</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">thresholds</span><span class="p">[</span><span class="s1">&#39;failed_login_attempts&#39;</span><span class="p">]:</span>
                    <span class="n">alerts</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;brute_force_attempt&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;failed_attempts&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent_failures</span><span class="p">),</span>
                        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Multiple failed SSH login attempts detected: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">recent_failures</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">})</span>

        <span class="k">except</span> <span class="p">(</span><span class="n">subprocess</span><span class="o">.</span><span class="n">TimeoutExpired</span><span class="p">,</span> <span class="ne">FileNotFoundError</span><span class="p">):</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="n">alerts</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_security_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate comprehensive security report&quot;&quot;&quot;</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;system_status&#39;</span><span class="p">:</span> <span class="s1">&#39;scanning&#39;</span><span class="p">,</span>
            <span class="s1">&#39;alerts&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>

        <span class="c1"># Collect all alerts</span>
        <span class="n">all_alerts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_alerts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_anomalous_processes</span><span class="p">())</span>
        <span class="n">all_alerts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">detect_network_anomalies</span><span class="p">())</span>
        <span class="n">all_alerts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_file_integrity</span><span class="p">())</span>
        <span class="n">all_alerts</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analyze_system_logs</span><span class="p">())</span>

        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;alerts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">all_alerts</span>

        <span class="c1"># Generate summary</span>
        <span class="n">severity_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">alert_types</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">all_alerts</span><span class="p">:</span>
            <span class="n">severity_counts</span><span class="p">[</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">alert_types</span><span class="p">[</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;total_alerts&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_alerts</span><span class="p">),</span>
            <span class="s1">&#39;severity_breakdown&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">severity_counts</span><span class="p">),</span>
            <span class="s1">&#39;alert_types&#39;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">alert_types</span><span class="p">),</span>
            <span class="s1">&#39;system_health&#39;</span><span class="p">:</span> <span class="s1">&#39;critical&#39;</span> <span class="k">if</span> <span class="n">severity_counts</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;warning&#39;</span> <span class="k">if</span> <span class="n">severity_counts</span><span class="p">[</span><span class="s1">&#39;medium&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;good&#39;</span>
        <span class="p">}</span>

        <span class="c1"># Save report</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alerts_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">report</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">continuous_monitoring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">60</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run continuous threat monitoring&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Starting continuous monitoring (interval: </span><span class="si">{</span><span class="n">interval</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">)</span>

        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">report</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_security_report</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_alerts&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üö® SECURITY ALERT: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_alerts&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> alerts detected&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;System Health: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;system_health&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;alerts&#39;</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;high&#39;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  üî¥ HIGH: </span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;medium&#39;</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  üü° MEDIUM: </span><span class="si">{</span><span class="n">alert</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;‚úÖ System monitoring: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;system_health&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Stopping monitoring...&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">monitoring</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Monitoring error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">interval</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">detector</span> <span class="o">=</span> <span class="n">JetsonThreatDetector</span><span class="p">()</span>

    <span class="c1"># Create baseline if it doesn&#39;t exist</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">detector</span><span class="o">.</span><span class="n">baseline_file</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Creating system baseline...&quot;</span><span class="p">)</span>
        <span class="n">detector</span><span class="o">.</span><span class="n">create_system_baseline</span><span class="p">()</span>

    <span class="c1"># Generate initial report</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating security report...&quot;</span><span class="p">)</span>
    <span class="n">report</span> <span class="o">=</span> <span class="n">detector</span><span class="o">.</span><span class="n">generate_security_report</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Security Report: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;total_alerts&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> alerts, System Health: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;system_health&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Start continuous monitoring</span>
    <span class="n">detector</span><span class="o">.</span><span class="n">continuous_monitoring</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</code></pre></div>
<h3 id="3-iot-device-security-scanner">3. IoT Device Security Scanner<a class="headerlink" href="#3-iot-device-security-scanner" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># iot_security_scanner.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">nmap</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IoTSecurityScanner</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nm</span> <span class="o">=</span> <span class="n">nmap</span><span class="o">.</span><span class="n">PortScanner</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scan_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vulnerabilities</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">discover_iot_devices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_range</span><span class="o">=</span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Discover IoT devices on the network&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scanning network </span><span class="si">{</span><span class="n">network_range</span><span class="si">}</span><span class="s2"> for IoT devices...&quot;</span><span class="p">)</span>

        <span class="c1"># Perform network scan</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">hosts</span><span class="o">=</span><span class="n">network_range</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="s1">&#39;-sn&#39;</span><span class="p">)</span>

        <span class="n">devices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="o">.</span><span class="n">all_hosts</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="o">.</span><span class="n">state</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;up&#39;</span><span class="p">:</span>
                <span class="n">device_info</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="n">host</span><span class="p">,</span>
                    <span class="s1">&#39;hostname&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">]</span><span class="o">.</span><span class="n">hostname</span><span class="p">(),</span>
                    <span class="s1">&#39;mac&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;vendor&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s1">&#39;device_type&#39;</span><span class="p">:</span> <span class="s1">&#39;unknown&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;open_ports&#39;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s1">&#39;services&#39;</span><span class="p">:</span> <span class="p">[],</span>
                    <span class="s1">&#39;vulnerabilities&#39;</span><span class="p">:</span> <span class="p">[]</span>
                <span class="p">}</span>

                <span class="c1"># Get MAC address and vendor</span>
                <span class="k">if</span> <span class="s1">&#39;mac&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s1">&#39;addresses&#39;</span><span class="p">]:</span>
                    <span class="n">device_info</span><span class="p">[</span><span class="s1">&#39;mac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="p">[</span><span class="n">host</span><span class="p">][</span><span class="s1">&#39;addresses&#39;</span><span class="p">][</span><span class="s1">&#39;mac&#39;</span><span class="p">]</span>
                    <span class="c1"># Try to identify vendor from MAC</span>
                    <span class="n">device_info</span><span class="p">[</span><span class="s1">&#39;vendor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_identify_vendor</span><span class="p">(</span><span class="n">device_info</span><span class="p">[</span><span class="s1">&#39;mac&#39;</span><span class="p">])</span>

                <span class="n">devices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">device_info</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Discovered </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span><span class="si">}</span><span class="s2"> active devices&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">devices</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_identify_vendor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mac_address</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Identify device vendor from MAC address&quot;&quot;&quot;</span>
        <span class="c1"># Common IoT device MAC prefixes</span>
        <span class="n">iot_vendors</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;00:17:88&#39;</span><span class="p">:</span> <span class="s1">&#39;Philips Hue&#39;</span><span class="p">,</span>
            <span class="s1">&#39;18:B4:30&#39;</span><span class="p">:</span> <span class="s1">&#39;Nest Labs&#39;</span><span class="p">,</span>
            <span class="s1">&#39;44:61:32&#39;</span><span class="p">:</span> <span class="s1">&#39;Ubiquiti Networks&#39;</span><span class="p">,</span>
            <span class="s1">&#39;00:04:20&#39;</span><span class="p">:</span> <span class="s1">&#39;Slim Devices (Logitech)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;00:22:61&#39;</span><span class="p">:</span> <span class="s1">&#39;Honeywell&#39;</span><span class="p">,</span>
            <span class="s1">&#39;B8:27:EB&#39;</span><span class="p">:</span> <span class="s1">&#39;Raspberry Pi Foundation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DC:A6:32&#39;</span><span class="p">:</span> <span class="s1">&#39;Raspberry Pi Foundation&#39;</span><span class="p">,</span>
            <span class="s1">&#39;48:B0:2D&#39;</span><span class="p">:</span> <span class="s1">&#39;Amazon Technologies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;74:C2:46&#39;</span><span class="p">:</span> <span class="s1">&#39;Amazon Technologies&#39;</span><span class="p">,</span>
            <span class="s1">&#39;00:FC:8B&#39;</span><span class="p">:</span> <span class="s1">&#39;Amazon Technologies&#39;</span>
        <span class="p">}</span>

        <span class="n">mac_prefix</span> <span class="o">=</span> <span class="n">mac_address</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">iot_vendors</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mac_prefix</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_device_ports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">,</span> <span class="n">port_range</span><span class="o">=</span><span class="s2">&quot;1-1000&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scan for open ports on a device&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scanning ports on </span><span class="si">{</span><span class="n">device_ip</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">device_ip</span><span class="p">,</span> <span class="n">port_range</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span><span class="s1">&#39;-sV -sC&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">device_ip</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="o">.</span><span class="n">all_hosts</span><span class="p">():</span>
                <span class="n">host_info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nm</span><span class="p">[</span><span class="n">device_ip</span><span class="p">]</span>
                <span class="n">open_ports</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">services</span> <span class="o">=</span> <span class="p">[]</span>

                <span class="k">for</span> <span class="n">protocol</span> <span class="ow">in</span> <span class="n">host_info</span><span class="o">.</span><span class="n">all_protocols</span><span class="p">():</span>
                    <span class="n">ports</span> <span class="o">=</span> <span class="n">host_info</span><span class="p">[</span><span class="n">protocol</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
                        <span class="n">port_info</span> <span class="o">=</span> <span class="n">host_info</span><span class="p">[</span><span class="n">protocol</span><span class="p">][</span><span class="n">port</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">port_info</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;open&#39;</span><span class="p">:</span>
                            <span class="n">open_ports</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
                            <span class="n">service_info</span> <span class="o">=</span> <span class="p">{</span>
                                <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                                <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="n">protocol</span><span class="p">,</span>
                                <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="n">port_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">port_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">),</span>
                                <span class="s1">&#39;product&#39;</span><span class="p">:</span> <span class="n">port_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;product&#39;</span><span class="p">,</span> <span class="s1">&#39;unknown&#39;</span><span class="p">)</span>
                            <span class="p">}</span>
                            <span class="n">services</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">service_info</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">open_ports</span><span class="p">,</span> <span class="n">services</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error scanning </span><span class="si">{</span><span class="n">device_ip</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_default_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">,</span> <span class="n">services</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for default credentials on common IoT services&quot;&quot;&quot;</span>
        <span class="n">vulnerabilities</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Common default credentials for IoT devices</span>
        <span class="n">default_creds</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;admin&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;root&#39;</span><span class="p">,</span> <span class="s1">&#39;root&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;guest&#39;</span><span class="p">,</span> <span class="s1">&#39;guest&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;12345&#39;</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;admin&#39;</span><span class="p">,</span> <span class="s1">&#39;admin123&#39;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">service</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>
            <span class="n">service_name</span> <span class="o">=</span> <span class="n">service</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span>

            <span class="c1"># Check HTTP/HTTPS services</span>
            <span class="k">if</span> <span class="n">service_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">]:</span>
                <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;https&#39;</span> <span class="k">if</span> <span class="n">service_name</span> <span class="o">==</span> <span class="s1">&#39;https&#39;</span> <span class="k">else</span> <span class="s1">&#39;http&#39;</span>

                <span class="k">for</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">default_creds</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">protocol</span><span class="si">}</span><span class="s2">://</span><span class="si">{</span><span class="n">device_ip</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">/login&quot;</span>
                        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
                            <span class="n">url</span><span class="p">,</span>
                            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="n">username</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">password</span><span class="p">},</span>
                            <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                            <span class="n">verify</span><span class="o">=</span><span class="kc">False</span>
                        <span class="p">)</span>

                        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span> <span class="ow">and</span> <span class="s1">&#39;dashboard&#39;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                            <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;default_credentials&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
                                <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                                <span class="s1">&#39;credentials&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Default credentials found on </span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2"> service&quot;</span>
                            <span class="p">})</span>
                            <span class="k">break</span>

                    <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span><span class="p">:</span>
                        <span class="k">continue</span>

            <span class="c1"># Check SSH service</span>
            <span class="k">elif</span> <span class="n">service_name</span> <span class="o">==</span> <span class="s1">&#39;ssh&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">default_creds</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="kn">import</span><span class="w"> </span><span class="nn">paramiko</span>
                        <span class="n">ssh</span> <span class="o">=</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">SSHClient</span><span class="p">()</span>
                        <span class="n">ssh</span><span class="o">.</span><span class="n">set_missing_host_key_policy</span><span class="p">(</span><span class="n">paramiko</span><span class="o">.</span><span class="n">AutoAddPolicy</span><span class="p">())</span>
                        <span class="n">ssh</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">device_ip</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

                        <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;default_ssh_credentials&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;critical&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="s1">&#39;ssh&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                            <span class="s1">&#39;credentials&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Default SSH credentials found&quot;</span>
                        <span class="p">})</span>
                        <span class="n">ssh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                        <span class="k">break</span>

                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">continue</span>

        <span class="k">return</span> <span class="n">vulnerabilities</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_common_vulnerabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device_ip</span><span class="p">,</span> <span class="n">services</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check for common IoT vulnerabilities&quot;&quot;&quot;</span>
        <span class="n">vulnerabilities</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">service</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>
            <span class="n">service_name</span> <span class="o">=</span> <span class="n">service</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="c1"># Check for unencrypted services</span>
            <span class="k">if</span> <span class="n">service_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;telnet&#39;</span><span class="p">,</span> <span class="s1">&#39;ftp&#39;</span><span class="p">,</span> <span class="s1">&#39;http&#39;</span><span class="p">]:</span>
                <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unencrypted_service&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
                    <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Unencrypted </span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2"> service detected&quot;</span>
                <span class="p">})</span>

            <span class="c1"># Check for outdated software versions</span>
            <span class="k">if</span> <span class="n">version</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span><span class="n">old_version</span> <span class="ow">in</span> <span class="n">version</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">old_version</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;2.0&#39;</span><span class="p">,</span> <span class="s1">&#39;2.1&#39;</span><span class="p">]):</span>
                <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;outdated_software&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
                    <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                    <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Potentially outdated software version: </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">})</span>

            <span class="c1"># Check for unnecessary services</span>
            <span class="n">unnecessary_services</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;finger&#39;</span><span class="p">,</span> <span class="s1">&#39;chargen&#39;</span><span class="p">,</span> <span class="s1">&#39;discard&#39;</span><span class="p">,</span> <span class="s1">&#39;echo&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">service_name</span> <span class="ow">in</span> <span class="n">unnecessary_services</span><span class="p">:</span>
                <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unnecessary_service&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;service&#39;</span><span class="p">:</span> <span class="n">service_name</span><span class="p">,</span>
                    <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                    <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Unnecessary service </span><span class="si">{</span><span class="n">service_name</span><span class="si">}</span><span class="s2"> is running&quot;</span>
                <span class="p">})</span>

        <span class="k">return</span> <span class="n">vulnerabilities</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_security_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">devices</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate comprehensive IoT security report&quot;&quot;&quot;</span>
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;total_devices&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">devices</span><span class="p">),</span>
            <span class="s1">&#39;devices&#39;</span><span class="p">:</span> <span class="n">devices</span><span class="p">,</span>
            <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;critical_vulnerabilities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;high_vulnerabilities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;medium_vulnerabilities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;low_vulnerabilities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;secure_devices&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="s1">&#39;vulnerable_devices&#39;</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">},</span>
            <span class="s1">&#39;recommendations&#39;</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
            <span class="n">vuln_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;vulnerabilities&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">vuln_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;secure_devices&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;vulnerable_devices&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="k">for</span> <span class="n">vuln</span> <span class="ow">in</span> <span class="n">device</span><span class="p">[</span><span class="s1">&#39;vulnerabilities&#39;</span><span class="p">]:</span>
                    <span class="n">severity</span> <span class="o">=</span> <span class="n">vuln</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
                    <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">severity</span><span class="si">}</span><span class="s1">_vulnerabilities&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Generate recommendations</span>
        <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;critical_vulnerabilities&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;üî¥ CRITICAL: Immediately change default credentials and disable unnecessary services&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;high_vulnerabilities&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;üü† HIGH: Update firmware and enable encryption for all services&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;medium_vulnerabilities&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;üü° MEDIUM: Review service configurations and apply security patches&quot;</span><span class="p">)</span>

        <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
            <span class="s2">&quot;‚úÖ Implement network segmentation for IoT devices&quot;</span><span class="p">,</span>
            <span class="s2">&quot;‚úÖ Enable regular security monitoring and logging&quot;</span><span class="p">,</span>
            <span class="s2">&quot;‚úÖ Use strong, unique passwords for all devices&quot;</span><span class="p">,</span>
            <span class="s2">&quot;‚úÖ Keep firmware and software up to date&quot;</span>
        <span class="p">])</span>

        <span class="k">return</span> <span class="n">report</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">scan_network</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network_range</span><span class="o">=</span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform comprehensive IoT security scan&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üîç Starting IoT Security Scan...&quot;</span><span class="p">)</span>

        <span class="c1"># Discover devices</span>
        <span class="n">devices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">discover_iot_devices</span><span class="p">(</span><span class="n">network_range</span><span class="p">)</span>

        <span class="c1"># Scan each device</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="n">devices</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üì± Scanning device: </span><span class="si">{</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;vendor&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

            <span class="c1"># Port scan</span>
            <span class="n">open_ports</span><span class="p">,</span> <span class="n">services</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_device_ports</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">])</span>
            <span class="n">device</span><span class="p">[</span><span class="s1">&#39;open_ports&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">open_ports</span>
            <span class="n">device</span><span class="p">[</span><span class="s1">&#39;services&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">services</span>

            <span class="c1"># Vulnerability checks</span>
            <span class="n">vulnerabilities</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_default_credentials</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">],</span> <span class="n">services</span><span class="p">))</span>
            <span class="n">vulnerabilities</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">check_common_vulnerabilities</span><span class="p">(</span><span class="n">device</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">],</span> <span class="n">services</span><span class="p">))</span>
            <span class="n">device</span><span class="p">[</span><span class="s1">&#39;vulnerabilities&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vulnerabilities</span>

            <span class="c1"># Classify device type based on services</span>
            <span class="n">device</span><span class="p">[</span><span class="s1">&#39;device_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_classify_device_type</span><span class="p">(</span><span class="n">services</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">open_ports</span><span class="p">)</span><span class="si">}</span><span class="s2"> open ports, </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">vulnerabilities</span><span class="p">)</span><span class="si">}</span><span class="s2"> vulnerabilities&quot;</span><span class="p">)</span>

        <span class="c1"># Generate report</span>
        <span class="n">report</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_security_report</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>

        <span class="c1"># Save report</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/home/secops/data/iot_security_report.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">report</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">report</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_classify_device_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">services</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Classify device type based on running services&quot;&quot;&quot;</span>
        <span class="n">service_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">services</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;http&#39;</span> <span class="ow">in</span> <span class="n">service_names</span> <span class="ow">or</span> <span class="s1">&#39;https&#39;</span> <span class="ow">in</span> <span class="n">service_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;web_device&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;ssh&#39;</span> <span class="ow">in</span> <span class="n">service_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;linux_device&#39;</span>
        <span class="k">elif</span> <span class="s1">&#39;telnet&#39;</span> <span class="ow">in</span> <span class="n">service_names</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;legacy_device&#39;</span>
        <span class="k">elif</span> <span class="nb">any</span><span class="p">(</span><span class="n">port</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1883</span><span class="p">,</span> <span class="mi">8883</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">services</span> <span class="k">for</span> <span class="n">port</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]]):</span>
            <span class="k">return</span> <span class="s1">&#39;iot_sensor&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;unknown&#39;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">scanner</span> <span class="o">=</span> <span class="n">IoTSecurityScanner</span><span class="p">()</span>

    <span class="c1"># Scan local network</span>
    <span class="n">network</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Enter network range to scan (default: 192.168.1.0/24): &quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;192.168.1.0/24&quot;</span>

    <span class="n">report</span> <span class="o">=</span> <span class="n">scanner</span><span class="o">.</span><span class="n">scan_network</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìä IoT Security Scan Complete!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total devices: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;total_devices&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Vulnerable devices: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;vulnerable_devices&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Critical vulnerabilities: </span><span class="si">{</span><span class="n">report</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">][</span><span class="s1">&#39;critical_vulnerabilities&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">üìã Recommendations:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="s1">&#39;recommendations&#39;</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">rec</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="advanced-cybersecurity-lab-exercises">üéØ Advanced Cybersecurity Lab Exercises<a class="headerlink" href="#advanced-cybersecurity-lab-exercises" title="Permanent link">&para;</a></h2>
<h3 id="lab-1-container-based-security-monitoring">Lab 1: Container-Based Security Monitoring<a class="headerlink" href="#lab-1-container-based-security-monitoring" title="Permanent link">&para;</a></h3>
<p><strong>Objective</strong>: Set up comprehensive security monitoring in a containerized environment.</p>
<p><strong>Tasks</strong>:
1. Build and deploy the security toolkit container
2. Configure firewall rules for IoT communication
3. Implement real-time threat detection
4. Create automated security reports</p>
<p><strong>Deliverables</strong>:
- Running security container with monitoring dashboard
- Firewall configuration optimized for Jetson IoT use cases
- Threat detection system with custom rules
- Automated security report generation</p>
<h3 id="lab-2-iot-device-security-assessment">Lab 2: IoT Device Security Assessment<a class="headerlink" href="#lab-2-iot-device-security-assessment" title="Permanent link">&para;</a></h3>
<p><strong>Objective</strong>: Perform comprehensive security assessment of IoT devices on the network.</p>
<p><strong>Tasks</strong>:
1. Discover all IoT devices on the network
2. Identify device types and running services
3. Test for default credentials and common vulnerabilities
4. Generate security recommendations</p>
<p><strong>Deliverables</strong>:
- Complete IoT device inventory
- Vulnerability assessment report
- Risk prioritization matrix
- Remediation action plan</p>
<h3 id="lab-3-incident-response-automation">Lab 3: Incident Response Automation<a class="headerlink" href="#lab-3-incident-response-automation" title="Permanent link">&para;</a></h3>
<p><strong>Objective</strong>: Create automated incident response system for Jetson devices.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># incident_response_system.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">smtplib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.text</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">email.mime.multipart</span><span class="w"> </span><span class="kn">import</span> <span class="n">MIMEMultipart</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IncidentResponseSystem</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="o">=</span><span class="s1">&#39;/home/secops/data/incident_config.json&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_config</span><span class="p">(</span><span class="n">config_file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_setup_logging</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_load_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config_file</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load incident response configuration&quot;&quot;&quot;</span>
        <span class="n">default_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;smtp_server&#39;</span><span class="p">:</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
                <span class="s1">&#39;smtp_port&#39;</span><span class="p">:</span> <span class="mi">587</span><span class="p">,</span>
                <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;security@example.com&#39;</span><span class="p">,</span>
                <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;app_password&#39;</span><span class="p">,</span>
                <span class="s1">&#39;recipients&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;admin@example.com&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;response_actions&#39;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s1">&#39;high_severity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;isolate_device&#39;</span><span class="p">,</span> <span class="s1">&#39;notify_admin&#39;</span><span class="p">,</span> <span class="s1">&#39;backup_logs&#39;</span><span class="p">],</span>
                <span class="s1">&#39;medium_severity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;log_incident&#39;</span><span class="p">,</span> <span class="s1">&#39;notify_admin&#39;</span><span class="p">],</span>
                <span class="s1">&#39;low_severity&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;log_incident&#39;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s1">&#39;auto_remediation&#39;</span><span class="p">:</span> <span class="kc">True</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">config</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="c1"># Merge with defaults</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">default_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
                        <span class="n">config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">return</span> <span class="n">config</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">default_config</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">default_config</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_setup_logging</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Setup incident response logging&quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">handlers</span><span class="o">=</span><span class="p">[</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">FileHandler</span><span class="p">(</span><span class="s1">&#39;/home/secops/data/incident_response.log&#39;</span><span class="p">),</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_security_alert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Process a security alert and trigger appropriate response&quot;&quot;&quot;</span>
        <span class="n">incident_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;INC-</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">-%H%M%S&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">incident</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">incident_id</span><span class="p">,</span>
            <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
            <span class="s1">&#39;alert&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="p">,</span>
            <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;severity&#39;</span><span class="p">,</span> <span class="s1">&#39;low&#39;</span><span class="p">),</span>
            <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span>
            <span class="s1">&#39;actions_taken&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;resolution&#39;</span><span class="p">:</span> <span class="kc">None</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing incident </span><span class="si">{</span><span class="n">incident_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">alert</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown alert&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Determine response actions based on severity</span>
        <span class="n">severity</span> <span class="o">=</span> <span class="n">incident</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;response_actions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">severity</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;log_incident&#39;</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">actions</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;isolate_device&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_isolate_device</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;notify_admin&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_notify_admin</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;backup_logs&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_backup_logs</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">action</span> <span class="o">==</span> <span class="s1">&#39;log_incident&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_log_incident</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>

                <span class="n">incident</span><span class="p">[</span><span class="s1">&#39;actions_taken&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;completed&#39;</span>
                <span class="p">})</span>

            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to execute action </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">incident</span><span class="p">[</span><span class="s1">&#39;actions_taken&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                    <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="n">action</span><span class="p">,</span>
                    <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
                    <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;failed&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="p">})</span>

        <span class="c1"># Save incident record</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_save_incident</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">incident</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_isolate_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alert</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Isolate a compromised device from the network&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;remote_ip&#39;</span> <span class="ow">in</span> <span class="n">alert</span><span class="p">:</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;remote_ip&#39;</span><span class="p">]</span>
            <span class="c1"># Block IP using iptables</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;iptables&#39;</span><span class="p">,</span> <span class="s1">&#39;-A&#39;</span><span class="p">,</span> <span class="s1">&#39;INPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="s1">&#39;-j&#39;</span><span class="p">,</span> <span class="s1">&#39;DROP&#39;</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Isolated device with IP </span><span class="si">{</span><span class="n">ip</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;process&#39;</span> <span class="ow">in</span> <span class="n">alert</span> <span class="ow">and</span> <span class="s1">&#39;pid&#39;</span> <span class="ow">in</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;process&#39;</span><span class="p">]:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">alert</span><span class="p">[</span><span class="s1">&#39;process&#39;</span><span class="p">][</span><span class="s1">&#39;pid&#39;</span><span class="p">]</span>
            <span class="c1"># Terminate suspicious process</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;kill&#39;</span><span class="p">,</span> <span class="s1">&#39;-9&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">pid</span><span class="p">)],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Terminated suspicious process </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_notify_admin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Send email notification to administrators&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">MIMEMultipart</span><span class="p">()</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;From&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;To&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;recipients&#39;</span><span class="p">])</span>
            <span class="n">msg</span><span class="p">[</span><span class="s1">&#39;Subject&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Security Incident Alert: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="n">body</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            Security Incident Detected</span>

<span class="s2">            Incident ID: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">            Timestamp: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span>
<span class="s2">            Severity: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;severity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span>

<span class="s2">            Alert Details:</span>
<span class="s2">            Type: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;alert&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span><span class="si">}</span>
<span class="s2">            Description: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;alert&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;description&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No description&#39;</span><span class="p">)</span><span class="si">}</span>

<span class="s2">            Actions Taken:</span>
<span class="s2">            </span><span class="si">{</span><span class="nb">chr</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">action</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">action</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;actions_taken&#39;</span><span class="p">]])</span><span class="si">}</span>

<span class="s2">            Please review the incident and take appropriate action if needed.</span>

<span class="s2">            Jetson Security System</span>
<span class="s2">            &quot;&quot;&quot;</span>

            <span class="n">msg</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="n">MIMEText</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;plain&#39;</span><span class="p">))</span>

            <span class="n">server</span> <span class="o">=</span> <span class="n">smtplib</span><span class="o">.</span><span class="n">SMTP</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;smtp_server&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;smtp_port&#39;</span><span class="p">])</span>
            <span class="n">server</span><span class="o">.</span><span class="n">starttls</span><span class="p">()</span>
            <span class="n">server</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;username&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">][</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>
            <span class="n">server</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">server</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Email notification sent for incident </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to send email notification: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_backup_logs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Backup system logs for forensic analysis&quot;&quot;&quot;</span>
        <span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">_%H%M%S&#39;</span><span class="p">)</span>
        <span class="n">backup_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/home/secops/data/log_backup_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Create backup directory</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;mkdir&#39;</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">backup_dir</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Copy important log files</span>
        <span class="n">log_files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;/host/var/log/auth.log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;/host/var/log/syslog&#39;</span><span class="p">,</span>
            <span class="s1">&#39;/home/secops/data/security_alerts.json&#39;</span><span class="p">,</span>
            <span class="s1">&#39;/home/secops/data/firewall.log&#39;</span>
        <span class="p">]</span>

        <span class="k">for</span> <span class="n">log_file</span> <span class="ow">in</span> <span class="n">log_files</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="n">log_file</span><span class="p">,</span> <span class="n">backup_dir</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not backup </span><span class="si">{</span><span class="n">log_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logs backed up to </span><span class="si">{</span><span class="n">backup_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_log_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log incident to incident database&quot;&quot;&quot;</span>
        <span class="n">incident_file</span> <span class="o">=</span> <span class="s1">&#39;/home/secops/data/incidents.json&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">incident_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">incidents</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
            <span class="n">incidents</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">incidents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">incident</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">incident_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">incidents</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incident </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> logged to database&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_save_incident</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">incident</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save incident record&quot;&quot;&quot;</span>
        <span class="n">incident_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/home/secops/data/incident_</span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">.json&quot;</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">incident_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">incident</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Incident record saved: </span><span class="si">{</span><span class="n">incident_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Example usage</span>
    <span class="n">irs</span> <span class="o">=</span> <span class="n">IncidentResponseSystem</span><span class="p">()</span>

    <span class="c1"># Simulate a high-severity security alert</span>
    <span class="n">test_alert</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;brute_force_attempt&#39;</span><span class="p">,</span>
        <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span>
        <span class="s1">&#39;remote_ip&#39;</span><span class="p">:</span> <span class="s1">&#39;192.168.1.100&#39;</span><span class="p">,</span>
        <span class="s1">&#39;failed_attempts&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Multiple failed SSH login attempts detected from 192.168.1.100&#39;</span>
    <span class="p">}</span>

    <span class="n">incident</span> <span class="o">=</span> <span class="n">irs</span><span class="o">.</span><span class="n">process_security_alert</span><span class="p">(</span><span class="n">test_alert</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed incident: </span><span class="si">{</span><span class="n">incident</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p><strong>Tasks</strong>:
1. Configure automated incident response workflows
2. Set up email notifications for security alerts
3. Implement automatic threat isolation
4. Create incident tracking and reporting system</p>
<p><strong>Deliverables</strong>:
- Automated incident response system
- Email notification configuration
- Threat isolation procedures
- Incident tracking database</p>
<hr />
<h2 id="advanced-security-hardening-checklist">üîí Advanced Security Hardening Checklist<a class="headerlink" href="#advanced-security-hardening-checklist" title="Permanent link">&para;</a></h2>
<h3 id="jetson-specific-security-measures">Jetson-Specific Security Measures<a class="headerlink" href="#jetson-specific-security-measures" title="Permanent link">&para;</a></h3>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox" disabled/> <strong>Container Security</strong></li>
<li class="task-list-item"><input type="checkbox" disabled/> Run security tools in isolated containers</li>
<li class="task-list-item"><input type="checkbox" disabled/> Use minimal base images</li>
<li class="task-list-item"><input type="checkbox" disabled/> Implement container resource limits</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> Regular container image updates</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> <strong>Network Security</strong></p>
</li>
<li class="task-list-item"><input type="checkbox" disabled/> Configure firewall for IoT communication</li>
<li class="task-list-item"><input type="checkbox" disabled/> Implement network segmentation</li>
<li class="task-list-item"><input type="checkbox" disabled/> Monitor network traffic patterns</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> Use VPN for remote access</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> <strong>System Hardening</strong></p>
</li>
<li class="task-list-item"><input type="checkbox" disabled/> Disable unnecessary services</li>
<li class="task-list-item"><input type="checkbox" disabled/> Configure strong authentication</li>
<li class="task-list-item"><input type="checkbox" disabled/> Implement file integrity monitoring</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> Regular security updates</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> <strong>Monitoring &amp; Logging</strong></p>
</li>
<li class="task-list-item"><input type="checkbox" disabled/> Real-time threat detection</li>
<li class="task-list-item"><input type="checkbox" disabled/> Centralized log collection</li>
<li class="task-list-item"><input type="checkbox" disabled/> Automated alert generation</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> Incident response procedures</p>
</li>
<li class="task-list-item">
<p><input type="checkbox" disabled/> <strong>IoT Device Security</strong></p>
</li>
<li class="task-list-item"><input type="checkbox" disabled/> Change default credentials</li>
<li class="task-list-item"><input type="checkbox" disabled/> Enable encryption</li>
<li class="task-list-item"><input type="checkbox" disabled/> Regular firmware updates</li>
<li class="task-list-item"><input type="checkbox" disabled/> Device access control</li>
</ul>
<hr />
<h2 id="security-incident-response-playbook">üö® Security Incident Response Playbook<a class="headerlink" href="#security-incident-response-playbook" title="Permanent link">&para;</a></h2>
<h3 id="1-detection-phase">1. Detection Phase<a class="headerlink" href="#1-detection-phase" title="Permanent link">&para;</a></h3>
<ul>
<li>Monitor security alerts from automated systems</li>
<li>Analyze system logs for anomalies</li>
<li>Investigate user reports of suspicious activity</li>
</ul>
<h3 id="2-analysis-phase">2. Analysis Phase<a class="headerlink" href="#2-analysis-phase" title="Permanent link">&para;</a></h3>
<ul>
<li>Determine incident severity and scope</li>
<li>Identify affected systems and data</li>
<li>Collect evidence for forensic analysis</li>
</ul>
<h3 id="3-containment-phase">3. Containment Phase<a class="headerlink" href="#3-containment-phase" title="Permanent link">&para;</a></h3>
<ul>
<li>Isolate affected systems</li>
<li>Prevent lateral movement</li>
<li>Preserve evidence</li>
</ul>
<h3 id="4-eradication-phase">4. Eradication Phase<a class="headerlink" href="#4-eradication-phase" title="Permanent link">&para;</a></h3>
<ul>
<li>Remove malware and threats</li>
<li>Patch vulnerabilities</li>
<li>Update security controls</li>
</ul>
<h3 id="5-recovery-phase">5. Recovery Phase<a class="headerlink" href="#5-recovery-phase" title="Permanent link">&para;</a></h3>
<ul>
<li>Restore systems from clean backups</li>
<li>Monitor for recurring issues</li>
<li>Validate system integrity</li>
</ul>
<h3 id="6-lessons-learned">6. Lessons Learned<a class="headerlink" href="#6-lessons-learned" title="Permanent link">&para;</a></h3>
<ul>
<li>Document incident details</li>
<li>Update security procedures</li>
<li>Improve detection capabilities</li>
</ul>
<hr />
<h2 id="final-challenge-comprehensive-security-assessment">üéì Final Challenge: Comprehensive Security Assessment<a class="headerlink" href="#final-challenge-comprehensive-security-assessment" title="Permanent link">&para;</a></h2>
<p><strong>Scenario</strong>: You are tasked with securing a Jetson-based IoT deployment in a smart building environment.</p>
<p><strong>Requirements</strong>:
1. Deploy containerized security monitoring system
2. Perform comprehensive IoT device security assessment
3. Implement automated threat detection and response
4. Create security dashboard and reporting system
5. Develop incident response procedures
6. Document security architecture and procedures</p>
<p><strong>Evaluation Criteria</strong>:
- Security tool deployment and configuration
- Threat detection accuracy and response time
- IoT device vulnerability assessment completeness
- Incident response automation effectiveness
- Documentation quality and completeness</p>
<p><strong>Bonus Points</strong>:
- Integration with external security tools (SIEM)
- Machine learning-based anomaly detection
- Custom security rule development
- Performance optimization for Jetson hardware</p>
<hr />
<p>Next: Move into simulated attacks and red-team tools to learn how to defend against real-world scenarios in <code>01e_linux_cyber_attack_simulation.md</code>.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>